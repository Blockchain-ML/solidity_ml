F:\Blockchain\solidity_dataset_work\4k_dataset\95751.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 38
column: 55
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 66
column: 39
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 71
column: 38
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 76
column: 38
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 86
column: 38
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 95
column: 8
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 103
column: 8
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 105
column: 8
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 9
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 13
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uint256remaining);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 47
column: 2
content: functiontokenSupply()constantreturns(uinttokens){uintallowance=tokenContract.allowance(tokenHolder,address(this));uintbalance=tokenContract.balanceOf(tokenHolder);if(allowance<balance)returnallowance;elsereturnbalance;}

ruleId: SOLIDITY_MSGVALUE_EQUALS_ZERO
patternId: 1df89a
severity: 1
line: 80
column: 8
content: msg.value==0

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 38
column: 31
content: if(tx.origin!=owner)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 66
column: 6
content: if(!msg.sender.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 71
column: 6
content: if(!tx.origin.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 76
column: 6
content: if(!tx.origin.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 86
column: 6
content: if(!tx.origin.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 94
column: 6
content: if(!tokenContract.transferFrom(tokenHolder,tx.origin,_tokensToPurchase))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 102
column: 6
content: if(!tx.origin.send(msg.value-_supplyInEth))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 104
column: 6
content: if(!tokenContract.transferFrom(tokenHolder,tx.origin,_tokenSupply))throw;

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 38
column: 35
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 41
column: 12
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 71
column: 11
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 76
column: 11
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 86
column: 11
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 94
column: 51
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 98
column: 22
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 102
column: 11
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 104
column: 51
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 108
column: 22
content: tx.origin

ruleId: SOLIDITY_UNCHECKED_CALL
patternId: f39eed
severity: 3
line: 130
column: 8
content: send(_amount)

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 9
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 10
column: 4
content: functiontransfer(address_to,uint256_amount)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 11
column: 4
content: functiontransferFrom(address_from,address_to,uint256_amount)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 12
column: 4
content: functionapprove(address_spender,uint256_amount)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 13
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uint256remaining);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 40
column: 2
content: functionToken_Offer(address_tokenContract,address_tokenHolder,uint16_price){owner=tx.origin;tokenContract=TokenInterface(_tokenContract);tokenHolder=_tokenHolder;price=_price;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 47
column: 2
content: functiontokenSupply()constantreturns(uinttokens){uintallowance=tokenContract.allowance(tokenHolder,address(this));uintbalance=tokenContract.balanceOf(tokenHolder);if(allowance<balance)returnallowance;elsereturnbalance;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 54
column: 2
content: function(){buyTokens(price);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 58
column: 2
content: functionbuyTokens(){buyTokens(price);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 64
column: 2
content: functionbuyTokens(uint16_bidPrice){if(tx.origin!=msg.sender){if(!msg.sender.send(msg.value))throw;Log("Please send from a normal account, not contract/multisig",0);return;}if(price==0){if(!tx.origin.send(msg.value))throw;Log("Contract disabled",0);return;}if(_bidPrice<price){if(!tx.origin.send(msg.value))throw;Log("Bid too low, price is:",price);return;}if(msg.value==0){Log("No ether received",0);return;}uint_tokenSupply=tokenSupply();if(_tokenSupply==0){if(!tx.origin.send(msg.value))throw;Log("No tokens available, please try later",0);return;}uint_tokensToPurchase=(msg.value*1000)/price;if(_tokensToPurchase<=_tokenSupply){if(!tokenContract.transferFrom(tokenHolder,tx.origin,_tokensToPurchase))throw;tokensPurchasedTotal+=_tokensToPurchase;ethCostTotal+=msg.value;TokensPurchased(tx.origin,price,_tokensToPurchase,msg.value,msg.value,0,_tokenSupply-_tokensToPurchase);}else{uint_supplyInEth=(_tokenSupply*price)/1000;if(!tx.origin.send(msg.value-_supplyInEth))throw;if(!tokenContract.transferFrom(tokenHolder,tx.origin,_tokenSupply))throw;tokensPurchasedTotal+=_tokenSupply;ethCostTotal+=_supplyInEth;TokensPurchased(tx.origin,price,_tokenSupply,_supplyInEth,msg.value,msg.value-_supplyInEth,0);}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 113
column: 2
content: functionsetPrice(uint16_price)onlyOwnerAllowed{price=_price;Log("Price changed:",price);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 117
column: 2
content: functiontokenSupplyChanged()onlyOwnerAllowed{Log("Supply changed, new supply:",tokenSupply());}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 120
column: 2
content: functionsetTokenHolder(address_tokenHolder)onlyOwnerAllowed{tokenHolder=_tokenHolder;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 123
column: 2
content: functionsetOwner(address_owner)onlyOwnerAllowed{owner=_owner;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 126
column: 2
content: functiontransferETH(address_to,uint_amount)onlyOwnerAllowed{if(_amount>address(this).balance){_amount=address(this).balance;}_to.send(_amount);}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 6
column: 4
content: mapping(address=>uint256)balances;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 7
column: 4
content: mapping(address=>mapping(address=>uint256))allowed;

SOLIDITY_VISIBILITY :17
SOLIDITY_MSGVALUE_EQUALS_ZERO :1
SOLIDITY_DEPRECATED_CONSTRUCTIONS :11
SOLIDITY_REVERT_REQUIRE :8
SOLIDITY_UNCHECKED_CALL :1
SOLIDITY_TX_ORIGIN :10
