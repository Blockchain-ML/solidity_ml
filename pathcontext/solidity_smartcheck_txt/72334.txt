F:\Blockchain\dataset_new_byID\72334.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 49
column: 4
content: addressprivateconstantNULL_ADDRESS=address(0);

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: k4o1l4
severity: 1
line: 116
column: 8
content: while(_simulationData.orderId!=0&&_simulationData.amount>0&&gasleft()>GAS_BUFFER&&isMatch(_simulationData)){_simulationData.fillAmount=_simulationData.amount.min(_simulationData.orderAmount);_simulationData.sharesUsedInFill=_simulationData.fillAmount.min(_simulationData.availableShares);_simulationData.availableShares=_simulationData.availableShares.sub(_simulationData.sharesUsedInFill);if(_simulationData.orderCreator!=msg.sender){_sharesDepleted+=_simulationData.sharesUsedInFill;_tokensDepleted+=(_simulationData.fillAmount-_simulationData.sharesUsedInFill)*(_direction==Order.TradeDirections.Long?_simulationData.orderPrice:_simulationData.numTicks-_simulationData.orderPrice);}_sharesFilled+=_simulationData.fillAmount;_settlementFees+=getSettlementFees(_simulationData,_simulationData.sharesUsedInFill);_simulationData.amount-=_simulationData.fillAmount;_simulationData.orderId=orders.getWorseOrderId(_simulationData.orderId);_simulationData.orderAmount=orders.getAmount(_simulationData.orderId);_simulationData.orderPrice=orders.getPrice(_simulationData.orderId);_simulationData.orderShares=orders.getOrderSharesEscrowed(_simulationData.orderId);_simulationData.orderCreator=orders.getOrderCreator(_simulationData.orderId);_numFills+=1;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: k4o1l4
severity: 1
line: 153
column: 8
content: while(_orderIndex<_orders.length&&_simulationData.amount>0&&gasleft()>GAS_BUFFER){if(_simulationData.orderCreator!=msg.sender){_simulationData.fillAmount=_simulationData.amount.min(_simulationData.orderAmount);_simulationData.sharesUsedInFill=_simulationData.fillAmount.min(_simulationData.availableShares);_simulationData.availableShares=_simulationData.availableShares.sub(_simulationData.sharesUsedInFill);_sharesDepleted+=_simulationData.sharesUsedInFill;_tokensDepleted+=(_simulationData.fillAmount-_simulationData.sharesUsedInFill)*(_simulationData.direction==Order.TradeDirections.Long?_simulationData.orderPrice:_simulationData.numTicks-_simulationData.orderPrice);_sharesFilled+=_simulationData.fillAmount;_settlementFees+=getSettlementFees(_simulationData,_simulationData.sharesUsedInFill);_simulationData.amount-=_simulationData.fillAmount;_numFills+=1;}_orderIndex+=1;if(_orderIndex>=_orders.length){break;}IZeroXTrade.AugurOrderDatamemory_augurOrderData=zeroXTrade.parseOrderData(_orders[_orderIndex]);_simulationData.orderAmount=_orders[_orderIndex].makerAssetAmount;_simulationData.orderPrice=_augurOrderData.price;_simulationData.orderCreator=_orders[_orderIndex].makerAddress;_simulationData.orderShares=getNumberOfAvaialableShares(_simulationData.direction==Order.TradeDirections.Long?Order.TradeDirections.Short:Order.TradeDirections.Long,_simulationData.market,_simulationData.outcome,_simulationData.orderCreator);}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 114
column: 4
content: functionsimulateTrade(Order.TradeDirections_direction,IMarket_market,uint256_outcome,uint256_amount,uint256_price,bool_fillOnly)publicviewreturns(uint256_sharesFilled,uint256_tokensDepleted,uint256_sharesDepleted,uint256_settlementFees,uint256_numFills){SimulationDatamemory_simulationData=create(_direction,_market,_outcome,_amount,_price,msg.sender);while(_simulationData.orderId!=0&&_simulationData.amount>0&&gasleft()>GAS_BUFFER&&isMatch(_simulationData)){_simulationData.fillAmount=_simulationData.amount.min(_simulationData.orderAmount);_simulationData.sharesUsedInFill=_simulationData.fillAmount.min(_simulationData.availableShares);_simulationData.availableShares=_simulationData.availableShares.sub(_simulationData.sharesUsedInFill);if(_simulationData.orderCreator!=msg.sender){_sharesDepleted+=_simulationData.sharesUsedInFill;_tokensDepleted+=(_simulationData.fillAmount-_simulationData.sharesUsedInFill)*(_direction==Order.TradeDirections.Long?_simulationData.orderPrice:_simulationData.numTicks-_simulationData.orderPrice);}_sharesFilled+=_simulationData.fillAmount;_settlementFees+=getSettlementFees(_simulationData,_simulationData.sharesUsedInFill);_simulationData.amount-=_simulationData.fillAmount;_simulationData.orderId=orders.getWorseOrderId(_simulationData.orderId);_simulationData.orderAmount=orders.getAmount(_simulationData.orderId);_simulationData.orderPrice=orders.getPrice(_simulationData.orderId);_simulationData.orderShares=orders.getOrderSharesEscrowed(_simulationData.orderId);_simulationData.orderCreator=orders.getOrderCreator(_simulationData.orderId);_numFills+=1;}if(_simulationData.amount>0&&!_fillOnly){uint256_sharesUsedInCreate=_simulationData.amount.min(_simulationData.availableShares);_sharesDepleted+=_sharesUsedInCreate;_tokensDepleted+=(_simulationData.amount-_sharesUsedInCreate)*(_direction==Order.TradeDirections.Long?_simulationData.price:_simulationData.numTicks-_simulationData.price);}uint256_shareSaleProfit=_sharesDepleted*(_direction==Order.TradeDirections.Short?_simulationData.price:_simulationData.numTicks-_simulationData.price);_tokensDepleted=_shareSaleProfit>=_tokensDepleted?0:_tokensDepleted.sub(_shareSaleProfit);}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 149
column: 4
content: functionsimulateZeroXTrade(IExchange.Order[]memory_orders,uint256_amount,bool_fillOnly)publicviewreturns(uint256_sharesFilled,uint256_tokensDepleted,uint256_sharesDepleted,uint256_settlementFees,uint256_numFills){require(_orders.length>0,"Must provide orders to simulate zeroX trade");SimulationDatamemory_simulationData=createFromSignedOrders(_orders[0],_amount,msg.sender);uint256_orderIndex=0;while(_orderIndex<_orders.length&&_simulationData.amount>0&&gasleft()>GAS_BUFFER){if(_simulationData.orderCreator!=msg.sender){_simulationData.fillAmount=_simulationData.amount.min(_simulationData.orderAmount);_simulationData.sharesUsedInFill=_simulationData.fillAmount.min(_simulationData.availableShares);_simulationData.availableShares=_simulationData.availableShares.sub(_simulationData.sharesUsedInFill);_sharesDepleted+=_simulationData.sharesUsedInFill;_tokensDepleted+=(_simulationData.fillAmount-_simulationData.sharesUsedInFill)*(_simulationData.direction==Order.TradeDirections.Long?_simulationData.orderPrice:_simulationData.numTicks-_simulationData.orderPrice);_sharesFilled+=_simulationData.fillAmount;_settlementFees+=getSettlementFees(_simulationData,_simulationData.sharesUsedInFill);_simulationData.amount-=_simulationData.fillAmount;_numFills+=1;}_orderIndex+=1;if(_orderIndex>=_orders.length){break;}IZeroXTrade.AugurOrderDatamemory_augurOrderData=zeroXTrade.parseOrderData(_orders[_orderIndex]);_simulationData.orderAmount=_orders[_orderIndex].makerAssetAmount;_simulationData.orderPrice=_augurOrderData.price;_simulationData.orderCreator=_orders[_orderIndex].makerAddress;_simulationData.orderShares=getNumberOfAvaialableShares(_simulationData.direction==Order.TradeDirections.Long?Order.TradeDirections.Short:Order.TradeDirections.Long,_simulationData.market,_simulationData.outcome,_simulationData.orderCreator);}if(_simulationData.amount>0&&!_fillOnly){uint256_sharesUsedInCreate=_simulationData.amount.min(_simulationData.availableShares);_sharesDepleted+=_sharesUsedInCreate;_tokensDepleted+=(_simulationData.amount-_sharesUsedInCreate)*(_simulationData.direction==Order.TradeDirections.Long?_simulationData.price:_simulationData.numTicks-_simulationData.price);}uint256_shareSaleProfit=_sharesDepleted*(_simulationData.direction==Order.TradeDirections.Short?_simulationData.price:_simulationData.numTicks-_simulationData.price);_tokensDepleted=_shareSaleProfit>=_tokensDepleted?0:_tokensDepleted.sub(_shareSaleProfit);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 38f6c7
severity: 2
line: 116
column: 8
content: while(_simulationData.orderId!=0&&_simulationData.amount>0&&gasleft()>GAS_BUFFER&&isMatch(_simulationData)){_simulationData.fillAmount=_simulationData.amount.min(_simulationData.orderAmount);_simulationData.sharesUsedInFill=_simulationData.fillAmount.min(_simulationData.availableShares);_simulationData.availableShares=_simulationData.availableShares.sub(_simulationData.sharesUsedInFill);if(_simulationData.orderCreator!=msg.sender){_sharesDepleted+=_simulationData.sharesUsedInFill;_tokensDepleted+=(_simulationData.fillAmount-_simulationData.sharesUsedInFill)*(_direction==Order.TradeDirections.Long?_simulationData.orderPrice:_simulationData.numTicks-_simulationData.orderPrice);}_sharesFilled+=_simulationData.fillAmount;_settlementFees+=getSettlementFees(_simulationData,_simulationData.sharesUsedInFill);_simulationData.amount-=_simulationData.fillAmount;_simulationData.orderId=orders.getWorseOrderId(_simulationData.orderId);_simulationData.orderAmount=orders.getAmount(_simulationData.orderId);_simulationData.orderPrice=orders.getPrice(_simulationData.orderId);_simulationData.orderShares=orders.getOrderSharesEscrowed(_simulationData.orderId);_simulationData.orderCreator=orders.getOrderCreator(_simulationData.orderId);_numFills+=1;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 38f6c7
severity: 2
line: 153
column: 8
content: while(_orderIndex<_orders.length&&_simulationData.amount>0&&gasleft()>GAS_BUFFER){if(_simulationData.orderCreator!=msg.sender){_simulationData.fillAmount=_simulationData.amount.min(_simulationData.orderAmount);_simulationData.sharesUsedInFill=_simulationData.fillAmount.min(_simulationData.availableShares);_simulationData.availableShares=_simulationData.availableShares.sub(_simulationData.sharesUsedInFill);_sharesDepleted+=_simulationData.sharesUsedInFill;_tokensDepleted+=(_simulationData.fillAmount-_simulationData.sharesUsedInFill)*(_simulationData.direction==Order.TradeDirections.Long?_simulationData.orderPrice:_simulationData.numTicks-_simulationData.orderPrice);_sharesFilled+=_simulationData.fillAmount;_settlementFees+=getSettlementFees(_simulationData,_simulationData.sharesUsedInFill);_simulationData.amount-=_simulationData.fillAmount;_numFills+=1;}_orderIndex+=1;if(_orderIndex>=_orders.length){break;}IZeroXTrade.AugurOrderDatamemory_augurOrderData=zeroXTrade.parseOrderData(_orders[_orderIndex]);_simulationData.orderAmount=_orders[_orderIndex].makerAssetAmount;_simulationData.orderPrice=_augurOrderData.price;_simulationData.orderCreator=_orders[_orderIndex].makerAddress;_simulationData.orderShares=getNumberOfAvaialableShares(_simulationData.direction==Order.TradeDirections.Long?Order.TradeDirections.Short:Order.TradeDirections.Long,_simulationData.market,_simulationData.outcome,_simulationData.orderCreator);}

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 49
column: 12
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 50
column: 12
content: private

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 114
column: 165
content: (uint256_sharesFilled,uint256_tokensDepleted,uint256_sharesDepleted,uint256_settlementFees,uint256_numFills)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 149
column: 119
content: (uint256_sharesFilled,uint256_tokensDepleted,uint256_sharesDepleted,uint256_settlementFees,uint256_numFills)

SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :2
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :2
SOLIDITY_EXTRA_GAS_IN_LOOPS :2
SOLIDITY_ADDRESS_HARDCODED :1
SOLIDITY_GAS_LIMIT_IN_LOOPS :2
SOLIDITY_SHOULD_RETURN_STRUCT :2
