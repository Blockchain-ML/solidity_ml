F:\Blockchain\solidity_dataset_work\7k_dataset_ByID\86569.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 267
column: 12
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 283
column: 12
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 322
column: 16
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 344
column: 16
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 377
column: 12
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 70
column: 16
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 149
column: 16
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 16
column: 4
content: functioncanCall(addresssrc,addressdst,bytes4sig)constantreturns(bool);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 75
column: 4
content: functiontotalSupply()constantreturns(uintsupply);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 76
column: 4
content: functionbalanceOf(addresswho)constantreturns(uintvalue);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 77
column: 4
content: functionallowance(addressowner,addressspender)constantreturns(uint_allowance);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 182
column: 4
content: functionisActive(uintid)constantreturns(boolactive){returnoffers[id].active;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 185
column: 4
content: functiongetOwner(uintid)constantreturns(addressowner){returnoffers[id].owner;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 188
column: 4
content: functiongetOffer(uintid)constantreturns(uint,ERC20,uint,ERC20){varoffer=offers[id];return(offer.sell_how_much,offer.sell_which_token,offer.buy_how_much,offer.buy_which_token);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 407
column: 4
content: functiongetTime()constantreturns(uint){returnblock.timestamp;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 410
column: 4
content: functionisClosed()constantreturns(boolclosed){returnstopped||(getTime()>close_time);}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 2
column: 16
content: ^

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 70
column: 8
content: if(!x)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 149
column: 8
content: if(!x)throw;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 16
column: 4
content: functioncanCall(addresssrc,addressdst,bytes4sig)constantreturns(bool);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 30
column: 4
content: functionDSAuth(){owner=msg.sender;LogSetOwner(msg.sender);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 35
column: 4
content: functionsetOwner(addressowner_)auth{owner=owner_;LogSetOwner(owner);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 42
column: 4
content: functionsetAuthority(DSAuthorityauthority_)auth{authority=authority_;LogSetAuthority(authority);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 75
column: 4
content: functiontotalSupply()constantreturns(uintsupply);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 76
column: 4
content: functionbalanceOf(addresswho)constantreturns(uintvalue);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 77
column: 4
content: functionallowance(addressowner,addressspender)constantreturns(uint_allowance);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 79
column: 4
content: functiontransfer(addressto,uintvalue)returns(boolok);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 80
column: 4
content: functiontransferFrom(addressfrom,addressto,uintvalue)returns(boolok);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 81
column: 4
content: functionapprove(addressspender,uintvalue)returns(boolok);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 182
column: 4
content: functionisActive(uintid)constantreturns(boolactive){returnoffers[id].active;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 185
column: 4
content: functiongetOwner(uintid)constantreturns(addressowner){returnoffers[id].owner;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 188
column: 4
content: functiongetOffer(uintid)constantreturns(uint,ERC20,uint,ERC20){varoffer=offers[id];return(offer.sell_how_much,offer.sell_which_token,offer.buy_how_much,offer.buy_which_token);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 218
column: 4
content: functionmake(ERC20haveToken,ERC20wantToken,uint128haveAmount,uint128wantAmount)returns(bytes32id){returnbytes32(offer(haveAmount,haveToken,wantAmount,wantToken));}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 227
column: 4
content: functiontake(bytes32id,uint128maxTakeAmount){assert(buy(uint256(id),maxTakeAmount));}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 231
column: 4
content: functionkill(bytes32id){assert(cancel(uint256(id)));}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 236
column: 4
content: functionoffer(uintsell_how_much,ERC20sell_which_token,uintbuy_how_much,ERC20buy_which_token)can_offersynchronizedreturns(uintid){assert(uint128(sell_how_much)==sell_how_much);assert(uint128(buy_how_much)==buy_how_much);assert(sell_how_much>0);assert(sell_which_token!=ERC20(0x0));assert(buy_how_much>0);assert(buy_which_token!=ERC20(0x0));assert(sell_which_token!=buy_which_token);OfferInfomemoryinfo;info.sell_how_much=sell_how_much;info.sell_which_token=sell_which_token;info.buy_how_much=buy_how_much;info.buy_which_token=buy_which_token;info.owner=msg.sender;info.active=true;info.timestamp=uint64(now);id=next_id();offers[id]=info;varseller_paid=sell_which_token.transferFrom(msg.sender,this,sell_how_much);assert(seller_paid);ItemUpdate(id);LogMake(bytes32(id),sha3(sell_which_token,buy_which_token),msg.sender,sell_which_token,buy_which_token,uint128(sell_how_much),uint128(buy_how_much),uint64(now));}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 277
column: 4
content: functionbump(bytes32id_)can_buy(uint256(id_)){varid=uint256(id_);LogBump(id_,sha3(offers[id].sell_which_token,offers[id].buy_which_token),offers[id].owner,offers[id].sell_which_token,offers[id].buy_which_token,uint128(offers[id].sell_how_much),uint128(offers[id].buy_how_much),offers[id].timestamp);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 295
column: 4
content: functionbuy(uintid,uintquantity)can_buy(id)synchronizedreturns(boolsuccess){assert(uint128(quantity)==quantity);OfferInfomemoryoffer=offers[id];uintspend=safeMul(quantity,offer.buy_how_much)/offer.sell_how_much;assert(uint128(spend)==spend);if(spend>offer.buy_how_much||quantity>offer.sell_how_much){success=false;}elseif(spend==offer.buy_how_much&&quantity==offer.sell_how_much){deleteoffers[id];trade(offer.owner,quantity,offer.sell_which_token,msg.sender,spend,offer.buy_which_token);ItemUpdate(id);LogTake(bytes32(id),sha3(offer.sell_which_token,offer.buy_which_token),offer.owner,offer.sell_which_token,offer.buy_which_token,msg.sender,uint128(offer.sell_how_much),uint128(offer.buy_how_much),uint64(now));success=true;}elseif(spend>0&&quantity>0){offers[id].sell_how_much=safeSub(offer.sell_how_much,quantity);offers[id].buy_how_much=safeSub(offer.buy_how_much,spend);trade(offer.owner,quantity,offer.sell_which_token,msg.sender,spend,offer.buy_which_token);ItemUpdate(id);LogTake(bytes32(id),sha3(offer.sell_which_token,offer.buy_which_token),offer.owner,offer.sell_which_token,offer.buy_which_token,msg.sender,uint128(quantity),uint128(spend),uint64(now));success=true;}else{success=false;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 362
column: 4
content: functioncancel(uintid)can_cancel(id)synchronizedreturns(boolsuccess){OfferInfomemoryoffer=offers[id];deleteoffers[id];varseller_refunded=offer.sell_which_token.transfer(offer.owner,offer.sell_how_much);assert(seller_refunded);ItemUpdate(id);LogKill(bytes32(id),sha3(offer.sell_which_token,offer.buy_which_token),offer.owner,offer.sell_which_token,offer.buy_which_token,uint128(offer.sell_how_much),uint128(offer.buy_how_much),uint64(now));success=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 398
column: 4
content: functionstop()auth{stopped=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 402
column: 4
content: functionExpiringMarket(uintlifetime_){lifetime=lifetime_;close_time=getTime()+lifetime_;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 407
column: 4
content: functiongetTime()constantreturns(uint){returnblock.timestamp;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 410
column: 4
content: functionisClosed()constantreturns(boolclosed){returnstopped||(getTime()>close_time);}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 139
column: 4
content: boollocked;

SOLIDITY_VISIBILITY :25
SOLIDITY_DEPRECATED_CONSTRUCTIONS :16
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_REVERT_REQUIRE :2
