F:\Blockchain\solidity_dataset_work\7k_dataset_ByID\88333.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 159
column: 4
content: functiongetFreeTokensInTranche(uint256_requiredTokens)internalconstantreturns(bool);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 161
column: 4
content: functionisNoEmptyTranches()publicconstantreturns(bool);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 229
column: 4
content: functiongetFreeTokensInTranche(uint256_requiredTokens)internalconstantreturns(bool){boolhasTokens=false;uint256indexOfTranche=defineTranchePeriod();hasTokens=tranches[indexOfTranche].valueForTranche>_requiredTokens;returnhasTokens;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 246
column: 4
content: functionisNoEmptyTranches()publicconstantreturns(bool){uint256sumFreeTokens=0;for(uinti=0;i<tranches.length;i++){sumFreeTokens=sumFreeTokens.add(tranches[i].valueForTranche);}boolisValid=sumFreeTokens>0;returnisValid;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 256
column: 4
content: functiondefineTranchePeriod()internalconstantreturns(uint256){for(uint256i=0;i<tranches.length;i++){if(tranches[i].valueForTranche>0){returni;}}returnMAX_TRANCHES+1;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 197
column: 8
content: for(uinti=0;i<_bonuses.length;i++){tranches.push(BonusSchedule({bonus:_bonuses[i],valueForTranche:_valueForTranches[i],rate:_rates[i]}));}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 248
column: 8
content: for(uinti=0;i<tranches.length;i++){sumFreeTokens=sumFreeTokens.add(tranches[i].valueForTranche);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 257
column: 8
content: for(uint256i=0;i<tranches.length;i++){if(tranches[i].valueForTranche>0){returni;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 197
column: 8
content: for(uinti=0;i<_bonuses.length;i++){tranches.push(BonusSchedule({bonus:_bonuses[i],valueForTranche:_valueForTranches[i],rate:_rates[i]}));}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 248
column: 8
content: for(uinti=0;i<tranches.length;i++){sumFreeTokens=sumFreeTokens.add(tranches[i].valueForTranche);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 257
column: 8
content: for(uint256i=0;i<tranches.length;i++){if(tranches[i].valueForTranche>0){returni;}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 107
column: 0
content: contractBountyisPullPayment,Destructible{boolpublicclaimed;mapping(address=>address)publicresearchers;eventTargetCreated(addresscreatedAddress);function()externalpayable{require(!claimed);}functioncreateTarget()publicreturns(Target){Targettarget=Target(deployContract());researchers[target]=msg.sender;TargetCreated(target);returntarget;}functiondeployContract()internalreturns(address);functionclaim(Targettarget)public{addressresearcher=researchers[target];require(researcher!=0);require(!target.checkInvariant());asyncSend(researcher,this.balance);claimed=true;}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 164
column: 0
content: contractTranchePricingStrategyisPricingStrategy,Target{usingSafeMathforuint256;uint256publictokensCap;uint256publiccapInWei;structBonusSchedule{uint256bonus;uintvalueForTranche;uintrate;}eventTokenForInvestor(uint256_token,uint256_tokenAndBonus,uint256indexOfperiod);uinttranchesCount=0;uintMAX_TRANCHES=50;BonusSchedule[]publictranches;functionTranchePricingStrategy(uint256[]_bonuses,uint[]_valueForTranches,uint[]_rates,uint256_capInWei,uint256_tokensCap)public{tokensCap=_tokensCap;capInWei=_capInWei;require(_bonuses.length==_valueForTranches.length&&_valueForTranches.length==_rates.length);require(_bonuses.length<=MAX_TRANCHES);tranchesCount=_bonuses.length;for(uinti=0;i<_bonuses.length;i++){tranches.push(BonusSchedule({bonus:_bonuses[i],valueForTranche:_valueForTranches[i],rate:_rates[i]}));}}functioncountTokens(uint256_value)internalreturns(uint256tokensAndBonus){uint256indexOfTranche=defineTranchePeriod();require(indexOfTranche!=MAX_TRANCHES+1);BonusSchedulecurrentTranche=tranches[indexOfTranche];uint256etherInWei=1e18;uint256bonusRate=currentTranche.bonus;uintval=msg.value*etherInWei;uint256oneTokenInWei=etherInWei/currentTranche.rate;uinttokens=val/oneTokenInWei;uint256bonusToken=tokens.mul(bonusRate).div(100);tokensAndBonus=tokens.add(bonusToken);soldInTranche(tokensAndBonus);weiRaised+=_value;TokenForInvestor(tokens,tokensAndBonus,indexOfTranche);returntokensAndBonus;}functiongetFreeTokensInTranche(uint256_requiredTokens)internalconstantreturns(bool){boolhasTokens=false;uint256indexOfTranche=defineTranchePeriod();hasTokens=tranches[indexOfTranche].valueForTranche>_requiredTokens;returnhasTokens;}functionsoldInTranche(uint256_tokensAndBonus)internal{uint256indexOfTranche=defineTranchePeriod();require(tranches[indexOfTranche].valueForTranche>=_tokensAndBonus);tranches[indexOfTranche].valueForTranche=tranches[indexOfTranche].valueForTranche.sub(_tokensAndBonus);totalSoldTokens=totalSoldTokens.add(_tokensAndBonus);}functionisNoEmptyTranches()publicconstantreturns(bool){uint256sumFreeTokens=0;for(uinti=0;i<tranches.length;i++){sumFreeTokens=sumFreeTokens.add(tranches[i].valueForTranche);}boolisValid=sumFreeTokens>0;returnisValid;}functiondefineTranchePeriod()internalconstantreturns(uint256){for(uint256i=0;i<tranches.length;i++){if(tranches[i].valueForTranche>0){returni;}}returnMAX_TRANCHES+1;}functioncheckInvariant()publicreturns(bool){uint256tranchePeriod=defineTranchePeriod();boolisTranchesDone=tranchePeriod==MAX_TRANCHES+1;boolisTokensCapReached=tokensCap==totalSoldTokens;boolisWeiCapReached=weiRaised==capInWei;boolisNoCapReached=isTranchesDone&&(!isTokensCapReached||!isWeiCapReached);boolisExceededCap=!isTranchesDone&&(isTokensCapReached||isWeiCapReached);if(isNoCapReached||isExceededCap){returnfalse;}returntrue;}functionpayContract()payable{countTokens(msg.value);}}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 2
column: 16
content: ^

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 80
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 165
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 102
column: 21
content: send(payment)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 187
column: 36
content: uint256[]_bonuses

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 187
column: 56
content: uint[]_valueForTranches

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 187
column: 82
content: uint[]_rates

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 299
column: 27
content: uint256[]_bonuses

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 299
column: 47
content: uint256[]_valueForTranches

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 300
column: 8
content: uint256[]_rates

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 441gim
severity: 1
line: 212
column: 8
content: BonusSchedulecurrentTranche=tranches[indexOfTranche]

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 286
column: 4
content: functionpayContract()payable{countTokens(msg.value);}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 180
column: 4
content: uinttranchesCount=0;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 181
column: 4
content: uintMAX_TRANCHES=50;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 296
column: 4
content: uint256capInWei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 297
column: 4
content: uint256capInTokens;

SOLIDITY_VISIBILITY :5
SOLIDITY_SAFEMATH :2
SOLIDITY_DEPRECATED_CONSTRUCTIONS :5
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :2
SOLIDITY_SEND :1
SOLIDITY_EXTRA_GAS_IN_LOOPS :3
SOLIDITY_UPGRADE_TO_050 :7
SOLIDITY_GAS_LIMIT_IN_LOOPS :3
