F:\Blockchain\solidity_dataset_work\7k_dataset_ByID\84582.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 6
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance);

ruleId: SOLIDITY_DIV_MUL
patternId: 09hhh1
severity: 2
line: 59
column: 24
content: msg.value/price*coeff

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 9
column: 0
content: contractBDSM_Crowdsale{tokenpublicsharesTokenAddress;addresspublicowner;addresspublicsafeContract;uintpublicstartICO_20_December=1513728060;uintpublicstopICO_20_March=1521504060;uintpublicincreasePrice_20_January=1516406460;uintpublicincreasePrice_20_February=1519084860;uintpublicprice=0.0035*1ether;uintcoeff=100000;uint256publictokenSold=0;uint256publictokenFree=0;boolpubliccrowdsaleClosed=false;boolpublictokenWithdraw=false;eventTokenFree(uint256value);eventCrowdsaleClosed(boolvalue);functionBDSM_Crowdsale(address_tokenAddress,address_owner,address_stopScamHolder){owner=_owner;sharesTokenAddress=token(_tokenAddress);safeContract=_stopScamHolder;}function()payable{if(now>increasePrice_20_February)price=0.070*1ether;elseif(now>increasePrice_20_January)price=0.00525*1ether;tokenFree=sharesTokenAddress.balanceOf(this);if(now<startICO_20_December){msg.sender.transfer(msg.value);}elseif(now>stopICO_20_March){msg.sender.transfer(msg.value);if(!tokenWithdraw){sharesTokenAddress.transfer(safeContract,sharesTokenAddress.balanceOf(this));tokenFree=sharesTokenAddress.balanceOf(this);tokenWithdraw=true;crowdsaleClosed=true;}}elseif(crowdsaleClosed){msg.sender.transfer(msg.value);}else{uint256tokenToBuy=msg.value/price*coeff;if(tokenToBuy<=0)msg.sender.transfer(msg.value);require(tokenToBuy>0);uint256actualETHTransfer=tokenToBuy*price/coeff;if(tokenFree>=tokenToBuy){owner.transfer(actualETHTransfer);if(msg.value>actualETHTransfer){msg.sender.transfer(msg.value-actualETHTransfer);}sharesTokenAddress.transfer(msg.sender,tokenToBuy);tokenSold+=tokenToBuy;tokenFree-=tokenToBuy;if(tokenFree==0)crowdsaleClosed=true;}else{uint256sendETH=tokenFree*price/coeff;owner.transfer(sendETH);sharesTokenAddress.transfer(msg.sender,tokenFree);msg.sender.transfer(msg.value-sendETH);tokenSold+=tokenFree;tokenFree=sharesTokenAddress.balanceOf(this);crowdsaleClosed=true;}}TokenFree(tokenFree);CrowdsaleClosed(crowdsaleClosed);}}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 2
column: 16
content: ^

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 5
column: 4
content: functiontransfer(address_to,uint256_value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 6
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 30
column: 1
content: functionBDSM_Crowdsale(address_tokenAddress,address_owner,address_stopScamHolder){owner=_owner;sharesTokenAddress=token(_tokenAddress);safeContract=_stopScamHolder;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 36
column: 1
content: function()payable{if(now>increasePrice_20_February)price=0.070*1ether;elseif(now>increasePrice_20_January)price=0.00525*1ether;tokenFree=sharesTokenAddress.balanceOf(this);if(now<startICO_20_December){msg.sender.transfer(msg.value);}elseif(now>stopICO_20_March){msg.sender.transfer(msg.value);if(!tokenWithdraw){sharesTokenAddress.transfer(safeContract,sharesTokenAddress.balanceOf(this));tokenFree=sharesTokenAddress.balanceOf(this);tokenWithdraw=true;crowdsaleClosed=true;}}elseif(crowdsaleClosed){msg.sender.transfer(msg.value);}else{uint256tokenToBuy=msg.value/price*coeff;if(tokenToBuy<=0)msg.sender.transfer(msg.value);require(tokenToBuy>0);uint256actualETHTransfer=tokenToBuy*price/coeff;if(tokenFree>=tokenToBuy){owner.transfer(actualETHTransfer);if(msg.value>actualETHTransfer){msg.sender.transfer(msg.value-actualETHTransfer);}sharesTokenAddress.transfer(msg.sender,tokenToBuy);tokenSold+=tokenToBuy;tokenFree-=tokenToBuy;if(tokenFree==0)crowdsaleClosed=true;}else{uint256sendETH=tokenFree*price/coeff;owner.transfer(sendETH);sharesTokenAddress.transfer(msg.sender,tokenFree);msg.sender.transfer(msg.value-sendETH);tokenSold+=tokenFree;tokenFree=sharesTokenAddress.balanceOf(this);crowdsaleClosed=true;}}TokenFree(tokenFree);CrowdsaleClosed(crowdsaleClosed);}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 20
column: 1
content: uintcoeff=100000;

SOLIDITY_VISIBILITY :5
SOLIDITY_DEPRECATED_CONSTRUCTIONS :1
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_DIV_MUL :1
