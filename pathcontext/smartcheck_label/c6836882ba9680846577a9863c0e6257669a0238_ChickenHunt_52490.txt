C:\Users\hp\DataSet\contracts\ropsten\c6\c6836882ba9680846577a9863c0e6257669a0238_ChickenHunt.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 515
column: 6
content: _house.pets.length=_id+1

ruleId: SOLIDITY_ERC20_APPROVE
patternId: af782c
severity: 2
line: 110
column: 2
content: functionapprove(address_spender,uint256_value)publicreturns(bool){allowed[msg.sender][_spender]=_value;emitApproval(msg.sender,_spender,_value);returntrue;}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 317
column: 0
content: contractCHHunterisCHGameBase{eventUpgrade(addressindexed_user,string_type,uint256_to);structConfig{uint256chicken;uint256ethereum;uint256max;}ConfigpublictypeA;ConfigpublictypeB;functionupgradeStrength(uint256_to)externalpayable{Housestorage_house=_houseOf(msg.sender);uint256_from=_house.hunter.strength;require(typeA.max>=_to&&_to>_from);_payForUpgrade(_from,_to,typeA);uint256_increment=_house.hunter.dexterity.mul(2).add(8).mul(_to.square()-_from**2);_house.hunter.strength=_to;_house.huntingPower=_house.huntingPower.add(_increment);_house.offensePower=_house.offensePower.add(_increment);emitUpgrade(msg.sender,"strength",_to);}functionupgradeDexterity(uint256_to)externalpayable{Housestorage_house=_houseOf(msg.sender);uint256_from=_house.hunter.dexterity;require(typeB.max>=_to&&_to>_from);_payForUpgrade(_from,_to,typeB);uint256_increment=_house.hunter.strength.square().mul((_to-_from).mul(2));_house.hunter.dexterity=_to;_house.huntingPower=_house.huntingPower.add(_increment);_house.offensePower=_house.offensePower.add(_increment);emitUpgrade(msg.sender,"dexterity",_to);}functionupgradeStructure(uint256_to)externalpayable{Housestorage_house=_houseOf(msg.sender);uint256_from=_house.barrier.structure;require(typeA.max>=_to&&_to>_from);_payForUpgrade(_from,_to,typeA);uint256_increment=_house.barrier.material.mul(2).add(8).mul(_to.square()-_from**2);_house.barrier.structure=_to;_house.defensePower=_house.defensePower.add(_increment);emitUpgrade(msg.sender,"structure",_to);}functionupgradeMaterial(uint256_to)externalpayable{Housestorage_house=_houseOf(msg.sender);uint256_from=_house.barrier.material;require(typeB.max>=_to&&_to>_from);_payForUpgrade(_from,_to,typeB);uint256_increment=_house.barrier.structure.square().mul((_to-_from).mul(2));_house.barrier.material=_to;_house.defensePower=_house.defensePower.add(_increment);emitUpgrade(msg.sender,"material",_to);}function_payForUpgrade(uint256_from,uint256_to,Config_type)internal{uint256_chickenCost=_type.chicken.mul(_gapOfCubeSum(_from,_to));_payChicken(msg.sender,_chickenCost);uint256_ethereumCost=_type.ethereum.mul(_gapOfSquareSum(_from,_to));_payEthereumAndDistribute(_ethereumCost);}function_gapOfSquareSum(uint256_before,uint256_after)internalpurereturns(uint256){require(_after==uint256(uint32(_after)));return(_after*(_after-1)*(2*_after-1)-_before*(_before-1)*(2*_before-1))/6;}function_gapOfCubeSum(uint256_before,uint256_after)internalpurereturns(uint256){require(_after==uint256(uint32(_after)));return((_after*(_after-1))**2-(_before*(_before-1))**2)>>2;}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 435
column: 0
content: contractCHHouseisCHHunter{eventUpgradePet(addressindexed_user,uint256_id,uint256_to);eventUpgradeDepot(addressindexed_user,uint256_to);eventBuyItem(addressindexed_from,addressindexed_to,uint256indexed_id,uint256_cost);eventBuyStore(addressindexed_from,addressindexed_to,uint256_cost);structPet{uint256huntingPower;uint256offensePower;uint256defensePower;uint256chicken;uint256ethereum;uint256max;}structItem{addressowner;uint256huntingMultiplier;uint256offenseMultiplier;uint256defenseMultiplier;uint256cost;}structDepot{uint256ethereum;uint256max;}uint256constantincrementRate=12;Depotpublicdepot;Pet[]publicpets;Item[]publicitems;functionbuyDepots(uint256_amount)externalpayable{Housestorage_house=_houseOf(msg.sender);_house.depots=_house.depots.add(_amount);require(_house.depots<=depot.max);_payEthereumAndDistribute(_amount.mul(depot.ethereum));emitUpgradeDepot(msg.sender,_house.depots);}functionbuyPets(uint256_id,uint256_amount)externalpayable{require(_id<pets.length);Petmemory_pet=pets[_id];uint256_chickenCost=_amount*_pet.chicken;_payChicken(msg.sender,_chickenCost);uint256_ethereumCost=_amount*_pet.ethereum;_payEthereumAndDistribute(_ethereumCost);Housestorage_house=_houseOf(msg.sender);if(_house.pets.length<_id+1){_house.pets.length=_id+1;}_house.pets[_id]=_house.pets[_id].add(_amount);require(_house.pets[_id]<=_pet.max);_house.huntingPower=_house.huntingPower.add(_pet.huntingPower*_amount);_house.offensePower=_house.offensePower.add(_pet.offensePower*_amount);_house.defensePower=_house.defensePower.add(_pet.defensePower*_amount);emitUpgradePet(msg.sender,_id,_house.pets[_id]);}functionbuyItem(uint256_id)externalpayable{Itemstorage_item=items[_id];address_from=_item.owner;uint256_price=_item.cost.mul(incrementRate)/10;_payEthereum(_price);saveChickenOf(_from);Housestorage_fromHouse=_houseOf(_from);_fromHouse.huntingMultiplier=_fromHouse.huntingMultiplier.sub(_item.huntingMultiplier);_fromHouse.offenseMultiplier=_fromHouse.offenseMultiplier.sub(_item.offenseMultiplier);_fromHouse.defenseMultiplier=_fromHouse.defenseMultiplier.sub(_item.defenseMultiplier);saveChickenOf(msg.sender);Housestorage_toHouse=_houseOf(msg.sender);_toHouse.huntingMultiplier=_toHouse.huntingMultiplier.add(_item.huntingMultiplier);_toHouse.offenseMultiplier=_toHouse.offenseMultiplier.add(_item.offenseMultiplier);_toHouse.defenseMultiplier=_toHouse.defenseMultiplier.add(_item.defenseMultiplier);uint256_halfMargin=_price.sub(_item.cost)/2;devFee=devFee.add(_halfMargin);ethereumBalance[_from]=ethereumBalance[_from].add(_price-_halfMargin);items[_id].cost=_price;items[_id].owner=msg.sender;emitBuyItem(_from,msg.sender,_id,_price);}functionbuyStore()externalpayable{address_from=store.owner;uint256_price=store.cost.mul(incrementRate)/10;_payEthereum(_price);uint256_halfMargin=(_price-store.cost)/2;devFee=devFee.add(_halfMargin);ethereumBalance[_from]=ethereumBalance[_from].add(_price-_halfMargin).add(store.balance);store.cost=_price;store.owner=msg.sender;deletestore.balance;emitBuyStore(_from,msg.sender,_price);}functionwithdrawStoreBalance()public{ethereumBalance[store.owner]=ethereumBalance[store.owner].add(store.balance);deletestore.balance;}}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 57
column: 2
content: usingSafeMathforuint256;

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 401
column: 4
content: Config_type

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 937
column: 28
content: string_name

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 937
column: 42
content: string_symbol

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1025
column: 6
content: uint256[]_pets

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 74
column: 2
content: uint256constantcorrection=1<<64;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 489
column: 2
content: uint256constantincrementRate=12;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 645
column: 2
content: uint256genesis;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 782
column: 2
content: addresscommittee;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 783
column: 2
content: addressdeveloper;

SOLIDITY_VISIBILITY :5
SOLIDITY_SAFEMATH :1
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_ARRAY_LENGTH_MANIPULATION :1
SOLIDITY_LOCKED_MONEY :2
SOLIDITY_UPGRADE_TO_050 :4
SOLIDITY_ERC20_APPROVE :1
