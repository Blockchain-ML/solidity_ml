C:\Users\hp\DataSet\contracts\ropsten\18\186673C7d7D1F1168504EC1bC9B6a0936F229a62_Sale.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 45
column: 4
content: owner=address(0)

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 415
column: 8
content: for(uinti=1;i<purchasedList.length;i++){if(purchasedList[i].product==_product&&purchasedList[i].buyer==_buyer){returnpurchasedList[i].id;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 439
column: 8
content: for(uinti=1;i<purchasedList.length;i++){if(isLive(i)&&(purchasedList[i].product==_product)){if(succeed<_count){Productproduct=Product(purchasedList[i].product);require(block.timestamp>=criterionTime.add(product.lockup()*1days));require(token.balanceOf(address(this))>=purchasedList[i].amount);purchasedList[i].release=true;token.safeTransfer(purchasedList[i].buyer,purchasedList[i].amount);succeed=succeed.add(1);emitReceipt(purchasedList[i].buyer,purchasedList[i].product,purchasedList[i].id,purchasedList[i].amount,purchasedList[i].etherAmount,purchasedList[i].release,purchasedList[i].refund);}else{remainder=remainder.add(1);}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 753
column: 4
content: for(uint256i=0;i<addrs.length;i++){addAddressToWhitelist(addrs[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 782
column: 4
content: for(uint256i=0;i<addrs.length;i++){removeAddressFromWhitelist(addrs[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 753
column: 4
content: for(uint256i=0;i<addrs.length;i++){addAddressToWhitelist(addrs[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 782
column: 4
content: for(uint256i=0;i<addrs.length;i++){removeAddressFromWhitelist(addrs[i]);}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 815
column: 0
content: contractSaleisStateable{usingSafeMathforuint256;usingMathforuint256;addresspublicwallet;WhitelistpublicwhiteList;Productpublicproduct;TokenDistributorpublictokenDistributor;mapping(address=>bool)isRegistered;mapping(address=>uint256)weiRaised;mapping(address=>mapping(address=>uint256))buyers;modifiervalidAddress(address_account){require(_account!=address(0));require(_account!=address(this));_;}modifiervalidProductAddress(address_product){require(!isRegistered[_product]);_;}modifierchangeProduct(){require(getState()==State.Unknown||getState()==State.Preparing||getState()==State.Finished);_;}constructor(address_wallet,address_whiteList,address_tokenDistributor)public{require(_wallet!=address(0));require(_whiteList!=address(0));require(_tokenDistributor!=address(0));wallet=_wallet;whiteList=Whitelist(_whiteList);tokenDistributor=TokenDistributor(_tokenDistributor);}functionregisterProduct(address_product)externalonlyOwnerchangeProductvalidAddress(_product)validProductAddress(_product){product=Product(_product);isRegistered[_product]=true;setState(State.Preparing);emitChangeExternalAddress(_product,"Product");}functionsetTokenDistributor(address_tokenDistributor)externalonlyOwnervalidAddress(_tokenDistributor){tokenDistributor=TokenDistributor(_tokenDistributor);emitChangeExternalAddress(_tokenDistributor,"TokenDistributor");}functionsetWhitelist(address_whitelist)externalonlyOwnervalidAddress(_whitelist){whiteList=Whitelist(_whitelist);emitChangeExternalAddress(_whitelist,"Whitelist");}functionsetWallet(address_wallet)externalonlyOwnervalidAddress(_wallet){wallet=_wallet;emitChangeExternalAddress(_wallet,"Wallet");}functionpause()externalonlyOwner{require(getState()==State.Starting);setState(State.Pausing);}functionstart()externalonlyOwner{require(getState()==State.Preparing||getState()==State.Pausing);setState(State.Starting);}functionfinish()externalonlyOwner{setState(State.Finished);}function()externalpayable{addressbuyer=msg.sender;uint256amount=msg.value;addressproductAddress=address(product);require(getState()==State.Starting);require(whiteList.whitelist(buyer));require(buyer!=address(0));require(weiRaised[productAddress]<product.maxcap());uint256buyerAmount=tokenDistributor.getEtherAmount(buyers[productAddress][buyer]);require(buyerAmount<product.exceed());require(buyerAmount.add(amount)>=product.minimum());uint256purchase;uint256refund;(purchase,refund)=getPurchaseDetail(buyerAmount,amount,productAddress);if(buyerAmount>0){tokenDistributor.addPurchased(buyers[productAddress][buyer],purchase.mul(product.rate()),purchase);}else{buyers[productAddress][buyer]=tokenDistributor.setPurchased(buyer,productAddress,purchase.mul(product.rate()),purchase);}wallet.transfer(purchase);if(refund>0){buyer.transfer(refund);}weiRaised[productAddress]=weiRaised[productAddress].add(purchase);if(weiRaised[productAddress]>=product.maxcap()){setState(State.Finished);}emitPurchase(buyer,purchase,refund,purchase.mul(product.rate()));}functiongetPurchaseDetail(uint256_buyerAmount,uint256_amount,address_product)privateviewreturns(uint256,uint256){uint256d1=product.maxcap().sub(weiRaised[_product]);uint256d2=product.exceed().sub(_buyerAmount);uint256possibleAmount=(d1.min256(d2)).min256(_amount);return(possibleAmount,_amount.sub(possibleAmount));}functionrefund(address_product,address_buyer)externalonlyOwnervalidAddress(_product)validAddress(_buyer){require(buyers[_product][_buyer]>0);boolisRefund;uint256refundAmount;(isRefund,refundAmount)=tokenDistributor.refund(buyers[_product][_buyer]);require(refundAmount>0);if(isRefund){weiRaised[_product]=weiRaised[_product].sub(refundAmount);deletebuyers[_product][_buyer];}}functionbuyerAddressTransfer(address_product,address_from,address_to)externalonlyOwnervalidAddress(_product)validAddress(_from)validAddress(_to){require(whiteList.whitelist(_from));require(whiteList.whitelist(_to));require(tokenDistributor.getEtherAmount(buyers[_product][_from])>0);require(tokenDistributor.getEtherAmount(buyers[_product][_to])==0);boolisChanged=tokenDistributor.buyerAddressTransfer(buyers[_product][_from],_from,_to);require(isChanged);uint256fromId=buyers[_product][_from];buyers[_product][_to]=fromId;deletebuyers[_product][_from];emitBuyerAddressTransfer(_from,_to,buyers[_product][_to]);}eventPurchase(addressindexed_buyer,uint256_purchased,uint256_refund,uint256_tokens);eventChangeExternalAddress(address_addr,string_name);eventBuyerAddressTransfer(addressindexed_from,addressindexed_to,uint256_id);}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 358
column: 4
content: functionsetPurchased(address_buyer,address_product,uint256_amount,uint256_etherAmount)externalonlyOwnervalidAddress(_buyer)validAddress(_product)returns(uint256){index=index.add(1);purchasedList.push(Purchased(_buyer,_product,index,_amount,_etherAmount,false,false));returnindex;emitReceipt(_buyer,_product,index,_amount,_etherAmount,false,false);}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 424
column: 4
content: functionsetCriterionTime(uint256_criterionTime)externalonlyOwner{require(_criterionTime>0);criterionTime=_criterionTime;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 873
column: 4
content: functionsetTokenDistributor(address_tokenDistributor)externalonlyOwnervalidAddress(_tokenDistributor){tokenDistributor=TokenDistributor(_tokenDistributor);emitChangeExternalAddress(_tokenDistributor,"TokenDistributor");}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 882
column: 4
content: functionsetWhitelist(address_whitelist)externalonlyOwnervalidAddress(_whitelist){whiteList=Whitelist(_whitelist);emitChangeExternalAddress(_whitelist,"Whitelist");}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 891
column: 4
content: functionsetWallet(address_wallet)externalonlyOwnervalidAddress(_wallet){wallet=_wallet;emitChangeExternalAddress(_wallet,"Wallet");}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 318
column: 16
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 319
column: 12
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 608
column: 33
content: private

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 304
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 816
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 959
column: 16
content: (uint256,uint256)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 108
column: 62
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 134
column: 8
content: string_name

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 619
column: 35
content: stringroleName

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 632
column: 33
content: stringroleName

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 645
column: 33
content: stringroleName

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 657
column: 36
content: stringroleName

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 749
column: 35
content: address[]addrs

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 778
column: 40
content: address[]addrs

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 71
column: 4
content: Statestate;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 156
column: 4
content: mapping(address=>bool)owners;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 317
column: 4
content: ERC20token;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 824
column: 4
content: mapping(address=>bool)isRegistered;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 825
column: 4
content: mapping(address=>uint256)weiRaised;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 826
column: 4
content: mapping(address=>mapping(address=>uint256))buyers;

SOLIDITY_VISIBILITY :6
SOLIDITY_SAFEMATH :2
SOLIDITY_OVERPOWERED_ROLE :5
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :3
SOLIDITY_EXTRA_GAS_IN_LOOPS :4
SOLIDITY_ADDRESS_HARDCODED :1
SOLIDITY_UPGRADE_TO_050 :8
SOLIDITY_GAS_LIMIT_IN_LOOPS :2
SOLIDITY_SHOULD_RETURN_STRUCT :1
