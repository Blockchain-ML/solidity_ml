C:\Users\hp\DataSet\contracts\ropsten\f3\f38b62d189e6b57eb3fa2ce4fb68812618e83866_HpbBallot.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 361
column: 9
content: voterArray[voterIndex].candidateHistoryMapAddrs.length--

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 369
column: 8
content: candidateArray.length--

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 346
column: 8
content: for(uintn=0;n<candidateArray[index].voterHistoryMapAddrs.length;n++){uintvoterIndex=voterIndexMap[candidateArray[index].voterHistoryMapAddrs[i]];uintcindex=0;for(uintk=0;k<voterArray[voterIndex].candidateHistoryMapAddrs.length-1;k++){if(voterArray[voterIndex].candidateHistoryMapAddrs[k]==_candidateAddr){cindex=k;}if(cindex>0&&k>=cindex){voterArray[voterIndex].candidateHistoryMapAddrs[k]=voterArray[voterIndex].candidateHistoryMapAddrs[k+1];}}deletevoterArray[voterIndex].candidateHistoryMapAddrs[voterArray[voterIndex].candidateHistoryMapAddrs.length-1];voterArray[voterIndex].candidateHistoryMapAddrs.length--;voterArray[voterIndex].candidateHistoryMap[_candidateAddr]=0;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 350
column: 9
content: for(uintk=0;k<voterArray[voterIndex].candidateHistoryMapAddrs.length-1;k++){if(voterArray[voterIndex].candidateHistoryMapAddrs[k]==_candidateAddr){cindex=k;}if(cindex>0&&k>=cindex){voterArray[voterIndex].candidateHistoryMapAddrs[k]=voterArray[voterIndex].candidateHistoryMapAddrs[k+1];}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 365
column: 8
content: for(uinti=index;i<candidateArray.length-1;i++){candidateArray[i]=candidateArray[i+1];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 402
column: 8
content: for(uinti=0;i<_nums.length;i++){sum=safeAdd(sum,_nums[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 408
column: 8
content: for(uintk=0;k<nums.length;k++){require(safeSub(voterAddr.balance,sum)>nums[k]);sum=safeAdd(sum,nums[k]);doVote(candidateAddrs[k],index,nums[k]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 429
column: 8
content: for(uinti=0;i<_nums.length;i++){sum=safeAdd(sum,_nums[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 434
column: 8
content: for(uintk=0;k<nums.length;k++){uintcandidateIndex=candidateIndexMap[candidateAddrs[k]];require(candidateIndex!=0);cancelVote(candidateAddrs[k],index,nums[k]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 490
column: 8
content: for(uinti=0;i<_nums.length;i++){sum=safeAdd(sum,_nums[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 529
column: 8
content: for(uinti=1;i<candidateArray[candidateIndex].voterHistoryMapAddrs.length-1;i++){if(voterArray[index].voterAddr==candidateArray[candidateIndex].voterHistoryMapAddrs[i]){hasVoterAddr=true;break;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 554
column: 12
content: for(uintk=1;k<voterArray[index].candidateHistoryMapAddrs.length-1;k++){if(candidateAddr==voterArray[index].candidateHistoryMapAddrs[k]){hasAddr=true;break;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 577
column: 12
content: for(uinti=0;i<candidateArray.length-1;i++){if(candidateArray[i].balance>0){candidateArray[i].candidateAddr.transfer(candidateArray[i].balance);candidateArray[i].balance=0;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 595
column: 8
content: for(uinti=1;i<candidateArray[candidateIndex].voterHistoryMapAddrs.length-1;i++){addressvoterAddr=candidateArray[candidateIndex].voterHistoryMapAddrs[i];uint[]memory_nums=calVote(voterAddr);for(uintk=1;k<_nums.length;i++){uintvoterIndex=voterIndexMap[voterAddr];if(_candidateAddr==voterArray[voterIndex].candidateHistoryMapAddrs[k]){_cnums[i]=_nums[k];break;}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 598
column: 12
content: for(uintk=1;k<_nums.length;i++){uintvoterIndex=voterIndexMap[voterAddr];if(_candidateAddr==voterArray[voterIndex].candidateHistoryMapAddrs[k]){_cnums[i]=_nums[k];break;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 633
column: 9
content: for(uinti=1;i<candidateArray.length-1;i++){if(!hasReleaseAmount){if(candidateArray[i].balance>0){candidateArray[i].candidateAddr.transfer(candidateArray[i].balance);candidateArray[i].balance=0;}}if(i<=capacity){_addrs[i-1]=candidateArray[i].candidateAddr;_facilityIds[i-1]=candidateArray[i].facilityId;_nums[i-1]=fechVoteNum(candidateArray[i].candidateAddr);if(_nums[i-1]<min){min=_nums[i-1];minIndex=i-1;}}else{if(candidateArray[i].numberOfVotes==min){if(candidateArray[i].candidateAddr.balance>_addrs[minIndex].balance){_addrs[minIndex]=candidateArray[i].candidateAddr;_facilityIds[minIndex]=candidateArray[i].facilityId;_nums[minIndex]=fechVoteNum(candidateArray[i].candidateAddr);}}elseif(candidateArray[i].numberOfVotes>min){_addrs[minIndex]=candidateArray[i].candidateAddr;_facilityIds[minIndex]=candidateArray[i].facilityId;_nums[minIndex]=fechVoteNum(candidateArray[i].candidateAddr);min=_nums[minIndex];}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 718
column: 11
content: for(uintk=0;i<voterArray[index].candidateHistoryMapAddrs.length-1;k++){_nums[k]=voterArray[index].candidateHistoryMap[voterArray[index].candidateHistoryMapAddrs[k]];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 725
column: 14
content: for(uinti=0;i<voterArray[index].candidateHistoryMapAddrs.length-1;i++){if(removeBal>0){if(removeBal<=voterArray[index].candidateHistoryMap[voterArray[index].candidateHistoryMapAddrs[i]]){_nums[i]=voterArray[index].candidateHistoryMap[voterArray[index].candidateHistoryMapAddrs[i]]-removeBal;}else{_nums[i]=0;removeBal=removeBal-voterArray[index].candidateHistoryMap[voterArray[index].candidateHistoryMapAddrs[i]];}}else{_nums[i]=voterArray[index].candidateHistoryMap[voterArray[index].candidateHistoryMapAddrs[i]];}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 763
column: 8
content: for(uinti=0;i<_nums.length;i++){sum=safeAdd(sum,_nums[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 346
column: 8
content: for(uintn=0;n<candidateArray[index].voterHistoryMapAddrs.length;n++){uintvoterIndex=voterIndexMap[candidateArray[index].voterHistoryMapAddrs[i]];uintcindex=0;for(uintk=0;k<voterArray[voterIndex].candidateHistoryMapAddrs.length-1;k++){if(voterArray[voterIndex].candidateHistoryMapAddrs[k]==_candidateAddr){cindex=k;}if(cindex>0&&k>=cindex){voterArray[voterIndex].candidateHistoryMapAddrs[k]=voterArray[voterIndex].candidateHistoryMapAddrs[k+1];}}deletevoterArray[voterIndex].candidateHistoryMapAddrs[voterArray[voterIndex].candidateHistoryMapAddrs.length-1];voterArray[voterIndex].candidateHistoryMapAddrs.length--;voterArray[voterIndex].candidateHistoryMap[_candidateAddr]=0;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 402
column: 8
content: for(uinti=0;i<_nums.length;i++){sum=safeAdd(sum,_nums[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 408
column: 8
content: for(uintk=0;k<nums.length;k++){require(safeSub(voterAddr.balance,sum)>nums[k]);sum=safeAdd(sum,nums[k]);doVote(candidateAddrs[k],index,nums[k]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 429
column: 8
content: for(uinti=0;i<_nums.length;i++){sum=safeAdd(sum,_nums[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 434
column: 8
content: for(uintk=0;k<nums.length;k++){uintcandidateIndex=candidateIndexMap[candidateAddrs[k]];require(candidateIndex!=0);cancelVote(candidateAddrs[k],index,nums[k]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 490
column: 8
content: for(uinti=0;i<_nums.length;i++){sum=safeAdd(sum,_nums[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 763
column: 8
content: for(uinti=0;i<_nums.length;i++){sum=safeAdd(sum,_nums[i]);}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 8
column: 8
content: if(x>MAX_UINT256-y){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 15
column: 8
content: if(x<y){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 25
column: 8
content: if(x>MAX_UINT256/y){revert();}

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 622
column: 41
content: (address[]addr,bytes32[]facilityIds,uint[]nums)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 772
column: 42
content: (address[]addr,uint[]nums)

ruleId: SOLIDITY_TRANSFER_IN_LOOP
patternId: 8jdj43
severity: 2
line: 577
column: 12
content: for(uinti=0;i<candidateArray.length-1;i++){if(candidateArray[i].balance>0){candidateArray[i].candidateAddr.transfer(candidateArray[i].balance);candidateArray[i].balance=0;}}

ruleId: SOLIDITY_TRANSFER_IN_LOOP
patternId: 8jdj43
severity: 2
line: 633
column: 9
content: for(uinti=1;i<candidateArray.length-1;i++){if(!hasReleaseAmount){if(candidateArray[i].balance>0){candidateArray[i].candidateAddr.transfer(candidateArray[i].balance);candidateArray[i].balance=0;}}if(i<=capacity){_addrs[i-1]=candidateArray[i].candidateAddr;_facilityIds[i-1]=candidateArray[i].facilityId;_nums[i-1]=fechVoteNum(candidateArray[i].candidateAddr);if(_nums[i-1]<min){min=_nums[i-1];minIndex=i-1;}}else{if(candidateArray[i].numberOfVotes==min){if(candidateArray[i].candidateAddr.balance>_addrs[minIndex].balance){_addrs[minIndex]=candidateArray[i].candidateAddr;_facilityIds[minIndex]=candidateArray[i].facilityId;_nums[minIndex]=fechVoteNum(candidateArray[i].candidateAddr);}}elseif(candidateArray[i].numberOfVotes>min){_addrs[minIndex]=candidateArray[i].candidateAddr;_facilityIds[minIndex]=candidateArray[i].facilityId;_nums[minIndex]=fechVoteNum(candidateArray[i].candidateAddr);min=_nums[minIndex];}}}

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 302
column: 8
content: string_name

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 323
column: 8
content: string_name

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 386
column: 8
content: address[]candidateAddrs

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 387
column: 5
content: uint[]nums

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 419
column: 2
content: address[]candidateAddrs

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 420
column: 5
content: uint[]nums

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 591
column: 8
content: uint[]nums

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 614
column: 8
content: address[]addr

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 615
column: 8
content: bytes32[]facilityIds

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 616
column: 8
content: uint[]nums

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 623
column: 8
content: address[]addr

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 624
column: 8
content: bytes32[]facilityIds

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 625
column: 8
content: uint[]nums

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 676
column: 8
content: address[]addr

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 677
column: 8
content: bytes32[]facilityIds

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 678
column: 8
content: uint[]nums

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 688
column: 8
content: address[]addrs

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 689
column: 8
content: uint[]nums

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 704
column: 8
content: uint[]nums

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 773
column: 8
content: address[]addr

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 774
column: 8
content: uint[]nums

SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_ARRAY_LENGTH_MANIPULATION :2
SOLIDITY_REVERT_REQUIRE :3
SOLIDITY_EXTRA_GAS_IN_LOOPS :17
SOLIDITY_UPGRADE_TO_050 :21
SOLIDITY_GAS_LIMIT_IN_LOOPS :7
SOLIDITY_SHOULD_RETURN_STRUCT :2
SOLIDITY_TRANSFER_IN_LOOP :2
