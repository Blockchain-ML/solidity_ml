C:\Users\hp\DataSet\Test.ESOP.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 25
column: 12
content: (root.ESOPAddress(),address(0))

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 130
column: 77
content: years

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 245
column: 64
content: years

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 261
column: 27
content: years

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 266
column: 75
content: years

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 400
column: 12
content: years

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 599
column: 25
content: years

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 599
column: 34
content: years

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 600
column: 25
content: years

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 600
column: 34
content: years

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 606
column: 25
content: years

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 606
column: 34
content: years

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 14
column: 2
content: functionsetUp(){emp1=newEmpTester();esop=makeNFESOP();emp1._target(esop);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 20
column: 2
content: functiontestUnsupportedFork()logs_gas{root.killOnUnsupportedFork();assertEq(root.ESOPAddress(),address(0));}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 28
column: 2
content: functiontestThrowTerminationBadLeaver(){uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,0,false);emp1.employeeSignsToESOP();uintmaxopts=esop.totalPoolOptions()-esop.remainingPoolOptions();ct+=uint32(esop.optionsCalculator().vestingPeriod()/2);esop.mockTime(ct);uint8rc=uint8(esop.terminateEmployee(emp1,ct,1));assertEq(uint(rc),0);uintoptions=esop.calcEffectiveOptionsForEmployee(emp1,ct);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 42
column: 2
content: functiontestThrowTerminationWhenNotSigned(){uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,0,false);uintmaxopts=esop.totalPoolOptions()-esop.remainingPoolOptions();ct+=uint32(esop.optionsCalculator().vestingPeriod()/2);esop.mockTime(ct);uint8rc=uint8(esop.terminateEmployee(emp1,ct,0));assertEq(uint(rc),0);uintoptions=esop.calcEffectiveOptionsForEmployee(emp1,ct);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 56
column: 2
content: functiontestOptionsBeforeAndAfterTermination(){uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,0,false);emp1._target(esop);emp1.employeeSignsToESOP();uintmaxopts=esop.totalPoolOptions()-esop.remainingPoolOptions();ct+=uint32(esop.optionsCalculator().vestingPeriod()/2);esop.mockTime(ct);uint8rc=uint8(esop.terminateEmployee(emp1,ct,0));assertEq(uint(rc),0);uintoptions=esop.calcEffectiveOptionsForEmployee(emp1,ct-1);assertEq(options,divRound(maxopts,2),"sec bef term");options=esop.calcEffectiveOptionsForEmployee(emp1,ct+1);assertEq(options,divRound(maxopts,2),"sec after term");ct-=uint32(esop.optionsCalculator().vestingPeriod()/4);esop.mockTime(ct);options=esop.calcEffectiveOptionsForEmployee(emp1,ct);assertEq(options,divRound(maxopts,4),"half bef term");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 78
column: 2
content: functiontestSuspendEmployee(){uint32ct=esop.currentTime();uint32issueDate=ct;esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,0,false);emp1.employeeSignsToESOP();uintmaxopts=esop.totalPoolOptions()-esop.remainingPoolOptions();ct+=uint32(esop.optionsCalculator().vestingPeriod()/2);esop.mockTime(ct);uint8rc=uint8(esop.toggleEmployeeSuspension(emp1,ct));assertEq(uint(rc),0);uintoptions=esop.calcEffectiveOptionsForEmployee(emp1,ct);assertEq(options,divRound(maxopts,2),"on suspension");options=esop.calcEffectiveOptionsForEmployee(emp1,ct-uint32(esop.optionsCalculator().vestingPeriod()/8));assertEq(options,divRound(3*maxopts,8),"before suspension");uint32suspensionPeriod=uint32(esop.optionsCalculator().vestingPeriod()/4);ct+=suspensionPeriod;esop.mockTime(ct);options=esop.calcEffectiveOptionsForEmployee(emp1,ct);assertEq(options,divRound(maxopts,2),"on suspension + 1y");rc=uint8(esop.toggleEmployeeSuspension(emp1,ct));assertEq(uint(rc),0);options=esop.calcEffectiveOptionsForEmployee(emp1,ct);assertEq(options,divRound(maxopts,2),"continue");ct+=uint32(esop.optionsCalculator().vestingPeriod()/4);esop.mockTime(ct);options=esop.calcEffectiveOptionsForEmployee(emp1,ct);assertEq(options,divRound(3*maxopts,4),"continue + 1y");rc=uint8(esop.toggleEmployeeSuspension(emp1,ct));assertEq(uint(rc),0);ct+=suspensionPeriod;esop.mockTime(ct);options=esop.calcEffectiveOptionsForEmployee(emp1,ct);assertEq(options,divRound(3*maxopts,4),"2 susp + 1y");rc=uint8(esop.terminateEmployee(emp1,ct,0));assertEq(uint(rc),0);options=esop.calcEffectiveOptionsForEmployee(emp1,ct);assertEq(options,divRound(3*maxopts,4),"2 susp + term");uintfadeout=esop.optionsCalculator().applyFadeoutToOptions(ct+uint32(esop.optionsCalculator().vestingPeriod()/8),issueDate+2*suspensionPeriod,ct,maxopts,options);options=esop.calcEffectiveOptionsForEmployee(emp1,ct+uint32(esop.optionsCalculator().vestingPeriod()/8));assertEq(options,fadeout,"2 susp + term + fadeout");options=esop.calcEffectiveOptionsForEmployee(emp1,ct-uint32(esop.optionsCalculator().vestingPeriod()/8));assertEq(options,divRound(5*maxopts,8),"2 susp + term + before");DummyOptionsConverterconverter=newDummyOptionsConverter(esop,ct+1years);rc=uint8(esop.offerOptionsConversion(converter));assertEq(uint(rc),0,"converter");options=esop.calcEffectiveOptionsForEmployee(emp1,ct+uint32(esop.optionsCalculator().vestingPeriod()/8));assertEq(options,divRound(3*maxopts,4),"2 susp + term + conv + after");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 138
column: 2
content: functionprocConversionStopsSuspended(boolaccelVesting){uint32ct=esop.currentTime();uint32issueDate=ct;esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,891721,false);emp1.employeeSignsToESOP();uintmaxopts=esop.totalPoolOptions()-esop.remainingPoolOptions();ct+=uint32(esop.optionsCalculator().vestingPeriod()/2);esop.mockTime(ct);uintrc=uint(esop.toggleEmployeeSuspension(emp1,ct));assertEq(uint(rc),0);uint32suspensionPeriod=uint32(esop.optionsCalculator().vestingPeriod()/4);ct+=suspensionPeriod;esop.mockTime(ct);DummyOptionsConverterconverter=newDummyOptionsConverter(esop,ct+4weeks);rc=uint(esop.offerOptionsConversion(converter));assertEq(rc,0,"converter");rc=uint(emp1.employeeExerciseOptions(accelVesting));assertEq(rc,0,"exercise accelv");uintdivisor=accelVesting?1:2;var(e1pool,e1extra,e1bonus,e1accel)=converter.getShare(address(emp1));assertEq(e1pool,divRound(maxopts,divisor),"e1pool");assertEq(e1extra,divRound(891721,divisor),"e1extra");uintbonus=accelVesting?divRound(maxopts*esop.optionsCalculator().bonusOptionsPromille(),esop.optionsCalculator().FP_SCALE()):0;assertEq(e1bonus,bonus,"e1bonus");assertEq(accelVesting,e1accel,'e1accel');}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 171
column: 2
content: functiontestConversionStopsSuspendedAccel(){procConversionStopsSuspended(true);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 175
column: 2
content: functiontestConversionStopsSuspendedNoAccel(){procConversionStopsSuspended(false);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 179
column: 2
content: functiontestTerminationOnConversion(){uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,10000,false);emp1.employeeSignsToESOP();uintmaxopts=esop.totalPoolOptions()-esop.remainingPoolOptions()+10000;ct+=uint32(esop.optionsCalculator().vestingPeriod()/2);esop.mockTime(ct);rc=uint8(esop.terminateEmployee(emp1,ct,0));assertEq(uint(rc),0);converter=newDummyOptionsConverter(address(esop),ct+60days);uint8rc=uint8(esop.offerOptionsConversion(converter));assertEq(uint(rc),0,"offerOptionsConversion");uintoptionsAtConv=esop.calcEffectiveOptionsForEmployee(address(emp1),ct);assertEq(optionsAtConv,maxopts/2,"no bonus on conv");optionsAtConv=esop.calcEffectiveOptionsForEmployee(address(emp1),ct+1weeks);assertEq(optionsAtConv,maxopts/2,"no bonus week later");emp1.employeeExerciseOptions(true);assertEq(converter.totalConvertedOptions(),maxopts/2,"still no bonus");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 205
column: 2
content: functiontestOptionsBeforeEmploymentStarted(){uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,10000,false);emp1.employeeSignsToESOP();uintoptions=esop.calcEffectiveOptionsForEmployee(emp1,ct-1);assertEq(options,0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 214
column: 2
content: functiontestWhenConvertedCalcOptionsBeforeConversion(){uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,10000,false);emp1.employeeSignsToESOP();uintmaxopts=esop.totalPoolOptions()-esop.remainingPoolOptions()+10000;ct+=uint32(esop.optionsCalculator().vestingPeriod()/2);esop.mockTime(ct);converter=newDummyOptionsConverter(address(esop),ct+60days);uint8rc=uint8(esop.offerOptionsConversion(converter));assertEq(uint(rc),0,"offerOptionsConversion");uintoptionsAtConv=esop.calcEffectiveOptionsForEmployee(address(emp1),ct-1);assertEq(optionsAtConv,maxopts/2,"vested still");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 231
column: 2
content: functionconversionFreezesOptions(boolterminate,boolexercise){uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,100,false);emp1.employeeSignsToESOP();ct+=uint32(3*esop.optionsCalculator().vestingPeriod()/4);esop.mockTime(ct);if(terminate)rc=uint8(esop.terminateEmployee(emp1,ct,0));assertEq(uint(rc),0);uintoptsOnTerm=esop.calcEffectiveOptionsForEmployee(address(emp1),ct);ct+=uint32(esop.optionsCalculator().vestingPeriod()/4);esop.mockTime(ct);converter=newDummyOptionsConverter(address(esop),ct+1years);uint8rc=uint8(esop.offerOptionsConversion(converter));assertEq(uint(rc),0,"offerOptionsConversion");varsere=esop.employees().getSerializedEmployee(address(emp1));uintoptionsAtConv=esop.optionsCalculator().calculateOptions(sere,ct,esop.conversionOfferedAt(),true);if(terminate&&esop.optionsCalculator().residualAmountPromille()>=3*esop.optionsCalculator().FP_SCALE()/4){return;}elseif(optsOnTerm==optionsAtConv){fail();}uintoptionsCv1y;if(exercise){esop.mockTime(ct+1years);rc=uint8(emp1.employeeExerciseOptions(false));assertEq(uint(rc),0,"opt exercise");optionsCv1y=converter.totalConvertedOptions();}else{optionsCv1y=esop.optionsCalculator().calculateOptions(sere,ct+1years,esop.conversionOfferedAt(),true);}assertEq(optionsCv1y,optionsAtConv);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 272
column: 2
content: functiontestConversionStopsFadeout(){conversionFreezesOptions(true,false);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 276
column: 2
content: functiontestConversionStopsVestingOfTerminated(){conversionFreezesOptions(true,true);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 280
column: 2
content: functiontestConversionStopsVesting(){conversionFreezesOptions(false,true);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 284
column: 2
content: functiontestNonAcceleratedOptionsConversion(){EmpTesteremp2=newEmpTester();uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,1289,false);uintemp1issued=esop.totalPoolOptions()-esop.remainingPoolOptions();esop.offerOptionsToEmployee(emp2,ct,ct+2weeks,7788,false);uintemp2issued=esop.totalPoolOptions()-esop.remainingPoolOptions()-emp1issued;emp2._target(esop);emp1.employeeSignsToESOP();emp2.employeeSignsToESOP();uint32vestp=uint32(esop.optionsCalculator().vestingPeriod());esop.mockTime(ct+vestp/2);uint32deadlineDelta=vestp/2+4weeks;DummyOptionsConverterconverter=newDummyOptionsConverter(esop,ct+deadlineDelta);uintrc=uint(esop.offerOptionsConversion(converter));assertEq(rc,0,"converter");rc=uint(emp1.employeeExerciseOptions(true));assertEq(rc,0,"exercise accelv");var(e1pool,e1extra,e1bonus,e1accel)=converter.getShare(address(emp1));assertEq(e1pool,emp1issued,"e1pool");assertEq(e1extra,1289,"e1extra");assertEq(e1bonus,divRound(emp1issued*esop.optionsCalculator().bonusOptionsPromille(),esop.optionsCalculator().FP_SCALE()),"e1bonus");assertEq(true,e1accel,'e1accel');rc=uint(emp2.employeeExerciseOptions(false));assertEq(rc,0,"exercise no accelv");(e1pool,e1extra,e1bonus,e1accel)=converter.getShare(address(emp2));assertEq(e1pool,divRound(emp2issued,2),"e2pool");assertEq(e1extra,divRound(7788,2),"e2extra");assertEq(e1bonus,0,"e2bonus");assertEq(false,e1accel,'e2accel');}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 319
column: 2
content: functiontestEmployeeDeniesToExerciseOptions(){uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,1289,false);uintemp1issued=esop.totalPoolOptions()-esop.remainingPoolOptions();emp1.employeeSignsToESOP();uint32vestp=uint32(esop.optionsCalculator().vestingPeriod());esop.mockTime(ct+vestp/2);uint32deadlineDelta=vestp/2+4weeks;DummyOptionsConverterconverter=newDummyOptionsConverter(esop,ct+deadlineDelta);uintrc=uint(esop.offerOptionsConversion(converter));assertEq(rc,0,"converter");rc=uint(emp1.employeeDenyExerciseOptions());assertEq(rc,0,"deny exercise");var(e1pool,e1extra,e1bonus,e1accel)=converter.getShare(address(emp1));assertEq(e1pool,0,"e1pool");assertEq(e1extra,0,"e1extra");assertEq(e1bonus,0,"e1bonus");assertEq(e1accel,false,'e1accel');rc=uint(emp1.employeeExerciseOptions(true));assertEq(rc,1,"exercise 2");rc=uint(emp1.employeeDenyExerciseOptions());assertEq(rc,1,"deny 2");assertEq(esop.calcEffectiveOptionsForEmployee(emp1,ct+vestp/2),0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 349
column: 2
content: functiontestExpiredOptionsConversion(){EmpTesteremp2=newEmpTester();uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,1289,false);uintemp1issued=esop.totalPoolOptions()-esop.remainingPoolOptions();esop.offerOptionsToEmployee(emp2,ct,ct+2weeks,7788,false);uintemp2issued=esop.totalPoolOptions()-esop.remainingPoolOptions()-emp1issued;emp2._target(esop);emp1.employeeSignsToESOP();emp2.employeeSignsToESOP();uint32vestp=uint32(esop.optionsCalculator().vestingPeriod());esop.mockTime(ct+vestp/2);uint32deadlineDelta=vestp/2+4weeks;DummyOptionsConverterconverter=newDummyOptionsConverter(esop,ct+deadlineDelta);uintrc=uint(esop.offerOptionsConversion(converter));assertEq(rc,0,"converter");rc=uint(esop.exerciseExpiredEmployeeOptions(emp1,true));assertEq(rc,4,"exercise accelv too early");esop.mockTime(ct+deadlineDelta+1);rc=uint(esop.exerciseExpiredEmployeeOptions(emp1,false));assertEq(rc,0,"exercise accelv");var(e1pool,e1extra,e1bonus,e1accel)=converter.getShare(address(this));assertEq(e1pool,emp1issued,"e1pool");assertEq(e1extra,1289,"e1extra");assertEq(e1bonus,divRound(emp1issued*esop.optionsCalculator().bonusOptionsPromille(),esop.optionsCalculator().FP_SCALE()),"e1bonus");assertEq(true,e1accel,'e1accel');rc=uint(esop.exerciseExpiredEmployeeOptions(emp2,true));assertEq(rc,0,"exercise no accelv");(e1pool,e1extra,e1bonus,e1accel)=converter.getShare(address(this));assertEq(e1pool,divRound(emp2issued,2),"e2pool");assertEq(e1extra,divRound(7788,2),"e2extra");assertEq(e1bonus,0,"e2bonus");assertEq(false,e1accel,'e2accel');rc=uint(esop.exerciseExpiredEmployeeOptions(emp1,true));assertEq(rc,1,"exercise accelv again");rc=uint(emp1.employeeExerciseOptions(true));assertEq(rc,2,"exercise accelv");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 395
column: 2
content: functiontestEmployeeConversion()logs_gas(){uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,100,false);emp1.employeeSignsToESOP();ct+=1years;esop.mockTime(ct);converter=newDummyOptionsConverter(address(esop),ct+2weeks);uint8rc=uint8(esop.offerOptionsConversion(converter));assertEq(uint(rc),0,"offerOptionsConversion");Employeememoryemp=deserializeEmployee(esop.employees().getSerializedEmployee(address(emp1)));uint32toolate=(ct+4weeks);esop.mockTime(toolate);rc=emp1.employeeExerciseOptions(true);assertEq(uint(rc),2,"employeeExerciseOptions too late");esop.mockTime(ct+2weeks);rc=emp1.employeeExerciseOptions(true);assertEq(uint(rc),0,"employeeExerciseOptions");uintpoolopts=esop.totalPoolOptions()-esop.remainingPoolOptions();uintexpopts=100+poolopts+divRound(poolopts*esop.optionsCalculator().bonusOptionsPromille(),esop.optionsCalculator().FP_SCALE());assertEq(converter.totalConvertedOptions(),expopts);rc=emp1.employeeExerciseOptions(true);assertEq(uint(rc),1,"already converted");uintoptions=esop.calcEffectiveOptionsForEmployee(address(emp1),ct+2weeks);assertEq(options,0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 434
column: 2
content: functiontestEmployeeSimpleLifecycle()logs_gas(){uint32ct=esop.currentTime();uintinitialOptions=esop.remainingPoolOptions();uint8rc=uint8(esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,100,false));assertEq(uint(rc),0);rc=emp1.employeeSignsToESOP();assertEq(uint(rc),0);esop.mockTime(ct+3weeks);rc=uint8(esop.terminateEmployee(emp1,ct+3weeks,1));assertEq(uint(rc),0);assertEq(initialOptions,esop.remainingPoolOptions());}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 448
column: 2
content: functiontestCodeUpdateCancel(){esop.beginCodeUpdate();esop.cancelCodeUpdate();uint32ct=esop.currentTime();uintrc=uint(esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,0,false));assertEq(rc,0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 458
column: 2
content: functiontestThrowOnCodeUpdate(){esop.beginCodeUpdate();uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,0,false);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 466
column: 2
content: functiontestSignTooLate(){uint32ct=esop.currentTime();uintrc=uint(esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,0,false));assertEq(rc,0);esop.mockTime(ct);ct+=2weeks;rc=emp1.employeeSignsToESOP();assertEq(rc,0,"on deadline");ct+=uint32(esop.optionsCalculator().cliffPeriod());esop.mockTime(ct);uintmaxopts=esop.totalPoolOptions()-esop.remainingPoolOptions();EmpTesteremp2=newEmpTester();emp2._target(esop);rc=uint(esop.offerOptionsToEmployee(emp2,ct,ct+2weeks,0,false));assertEq(rc,0);ct+=2weeks+1;esop.mockTime(ct);rc=emp2.employeeSignsToESOP();assertEq(rc,2,"on deadline + 1");assertEq(esop.remainingPoolOptions()+maxopts,esop.totalPoolOptions(),"emp2 removed");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 490
column: 2
content: functiontestOfferDeadlineTooSoon(){uint32ct=esop.currentTime();uintrc=uint(esop.offerOptionsToEmployeeOnlyExtra(emp1,ct,ct+esop.MINIMUM_MANUAL_SIGN_PERIOD()-1,100000));assertEq(rc,2);rc=uint(esop.offerOptionsToEmployee(emp1,ct,ct+esop.MINIMUM_MANUAL_SIGN_PERIOD()-1,100000,false));assertEq(rc,2);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 498
column: 2
content: functiontestConversionOfferDeadlineToSoon(){uint32ct=esop.currentTime();esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,10000,false);emp1.employeeSignsToESOP();ct+=uint32(esop.optionsCalculator().vestingPeriod()/2);esop.mockTime(ct);converter=newDummyOptionsConverter(address(esop),ct+esop.MINIMUM_MANUAL_SIGN_PERIOD()-1days);uintrc=uint(esop.offerOptionsConversion(converter));assertEq(rc,2,"converter");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 509
column: 2
content: functiontestIncreaseExtraOptions(){uint32ct=esop.currentTime();uintrc=uint(esop.offerOptionsToEmployeeOnlyExtra(emp1,ct,ct+2weeks,100000));assertEq(rc,0);emp1.employeeSignsToESOP();ct+=uint32(esop.optionsCalculator().vestingPeriod()/2);esop.mockTime(ct);rc=uint(esop.increaseEmployeeExtraOptions(emp1,20000));assertEq(rc,0);uintoptions=esop.calcEffectiveOptionsForEmployee(address(emp1),ct);assertEq(esop.totalExtraOptions(),120000,"total extra pool");assertEq(options,divRound(120000,2),"vested");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 523
column: 2
content: functiontestIncreaseEmployeeExtraOptionsNotSigned(){uint32ct=esop.currentTime();uintrc=uint(esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,50000,false));assertEq(rc,0);uintmaxopts=esop.totalPoolOptions()-esop.remainingPoolOptions();rc=uint(esop.increaseEmployeeExtraOptions(emp1,20000));assertEq(rc,0);rc=uint(emp1.employeeSignsToESOP());assertEq(rc,0);rc=uint(esop.increaseEmployeeExtraOptions(emp1,30000));assertEq(rc,0);ct+=uint32(esop.optionsCalculator().vestingPeriod()/2);esop.mockTime(ct);uintoptions=esop.calcEffectiveOptionsForEmployee(address(emp1),ct);assertEq(esop.totalExtraOptions(),100000,"total extra pool");assertEq(options,divRound(100000+maxopts,2),"vested");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 542
column: 2
content: functiontestFadeoutMoreThanCliff(){esop=makeESOPWithParams(7000);emp1._target(esop);uint32ct=esop.currentTime();uintrc=uint(esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,0,false));assertEq(rc,0);emp1.employeeSignsToESOP();uintmaxopts=esop.totalPoolOptions()-esop.remainingPoolOptions();ct+=uint32(esop.optionsCalculator().cliffPeriod()+1);esop.mockTime(ct);uintoptionsAtCliff=esop.calcEffectiveOptionsForEmployee(address(emp1),ct);if(optionsAtCliff>=divRound(esop.optionsCalculator().residualAmountPromille()*maxopts,esop.optionsCalculator().FP_SCALE())){return;}rc=uint(esop.terminateEmployee(emp1,ct,0));assertEq(rc,0);ct+=uint32(esop.optionsCalculator().cliffPeriod());uintfinalOpts=esop.calcEffectiveOptionsForEmployee(address(emp1),ct);assertEq(finalOpts,optionsAtCliff,"opts cliff == fade");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 569
column: 2
content: functiontestFadeoutDuringCliff(){uint32ct=esop.currentTime();uintrc=uint(esop.offerOptionsToEmployee(emp1,ct,ct+2weeks,0,false));assertEq(rc,0);emp1.employeeSignsToESOP();ct+=uint32(esop.optionsCalculator().cliffPeriod()/2);esop.mockTime(ct);rc=uint(esop.terminateEmployee(emp1,ct,0));assertEq(rc,0);ct+=uint32(esop.optionsCalculator().cliffPeriod());uintoptions=esop.calcEffectiveOptionsForEmployee(address(emp1),ct);assertEq(options,0,"opts fade == 0");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 585
column: 2
content: functiontestMockTime(){uint32t=esop.currentTime();assertEq(uint(t),block.timestamp);esop.mockTime(t+4weeks);assertEq(uint(esop.currentTime()),t+4weeks);esop.mockTime(0);assertEq(uint(esop.currentTime()),block.timestamp);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 596
column: 2
content: functiontestThrowOnSecondSetParameters(){OptionsCalculatorcalc=newOptionsCalculator(this);calc.setParameters(1years,4years,uint32(calc.FP_SCALE()),uint32(calc.FP_SCALE()),uint32(calc.FP_SCALE()),1);calc.setParameters(1years,4years,uint32(calc.FP_SCALE()),uint32(calc.FP_SCALE()),uint32(calc.FP_SCALE()),1);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 603
column: 2
content: functiontestOptionsCalculatorHasSetParameters(){OptionsCalculatorcalc=newOptionsCalculator(this);assertEq(calc.hasParameters(),false);calc.setParameters(1years,4years,uint32(calc.FP_SCALE()),uint32(calc.FP_SCALE()),uint32(calc.FP_SCALE()),1);assertEq(calc.hasParameters(),true);}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 10
column: 4
content: EmpTesteremp1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 11
column: 4
content: ESOPesop;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 12
column: 4
content: DummyOptionsConverterconverter;

SOLIDITY_VISIBILITY :36
SOLIDITY_DEPRECATED_CONSTRUCTIONS :11
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_ADDRESS_HARDCODED :1
