C:\Users\hp\DataSet\FeeDisbursal.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 181
column: 48
content: (token,address(0),msg.sender)

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 52
column: 36
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 329
column: 51
content: 0x0

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 65
column: 4
content: functiongetDisbursal(addresstoken,addressproRataToken,uint256index)publicconstantreturns(uint256snapshotId,uint256amount,uint256recycleableAfterTimestamp,uint256disburseTimestamp,addressdisburser){Disbursalstoragedisbursal=_disbursals[token][proRataToken][index];snapshotId=disbursal.snapshotId;amount=disbursal.amount;recycleableAfterTimestamp=disbursal.recycleableAfterTimestamp;disburseTimestamp=disbursal.disbursalTimestamp;disburser=disbursal.disburser;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 85
column: 4
content: functiongetNonClaimableDisbursals(addresstoken,addressproRataToken)publicconstantreturns(uint256[3][]memorydisbursals){uint256len=_disbursals[token][proRataToken].length;if(len==0){return;}uint256snapshotId=ITokenSnapshots(proRataToken).currentSnapshotId();uint256ii=len;while(_disbursals[token][proRataToken][ii-1].snapshotId==snapshotId&&--ii>0){}disbursals=newuint256[3][](len-ii);for(uint256jj=0;jj<len-ii;jj+=1){disbursals[jj][0]=snapshotId;disbursals[jj][1]=_disbursals[token][proRataToken][ii+jj].amount;disbursals[jj][2]=ii+jj;}}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 107
column: 4
content: functiongetDisbursalCount(addresstoken,addressproRataToken)publicconstantreturns(uint256){return_disbursals[token][proRataToken].length;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 193
column: 4
content: functionclaimable(addresstoken,ITokenSnapshotsproRataToken,addressclaimer,uint256until)publicconstantreturns(uint256claimableAmount,uint256totalAmount,uint256recycleableAfterTimestamp,uint256firstIndex){firstIndex=_disbursalProgress[token][proRataToken][claimer];if(firstIndex<_disbursals[token][proRataToken].length){recycleableAfterTimestamp=_disbursals[token][proRataToken][firstIndex].recycleableAfterTimestamp;}(claimableAmount,totalAmount,)=claimablePrivate(token,proRataToken,claimer,until,false);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 207
column: 4
content: functionclaimableMutipleByToken(address[]tokens,ITokenSnapshotsproRataToken,addressclaimer)publicconstantreturns(uint256[4][]claimables){claimables=newuint256[4][](tokens.length);for(uint256i=0;i<tokens.length;i+=1){claimables[i][3]=_disbursalProgress[tokens[i]][proRataToken][claimer];if(claimables[i][3]<_disbursals[tokens[i]][proRataToken].length){claimables[i][2]=_disbursals[tokens[i]][proRataToken][claimables[i][3]].recycleableAfterTimestamp;}(claimables[i][0],claimables[i][1],)=claimablePrivate(tokens[i],proRataToken,claimer,UINT256_MAX,false);}}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 223
column: 4
content: functionclaimableMutipleByProRataToken(addresstoken,ITokenSnapshots[]proRataTokens,addressclaimer)publicconstantreturns(uint256[4][]claimables){claimables=newuint256[4][](proRataTokens.length);for(uint256i=0;i<proRataTokens.length;i+=1){claimables[i][3]=_disbursalProgress[token][proRataTokens[i]][claimer];if(claimables[i][3]<_disbursals[token][proRataTokens[i]].length){claimables[i][2]=_disbursals[token][proRataTokens[i]][claimables[i][3]].recycleableAfterTimestamp;}(claimables[i][0],claimables[i][1],)=claimablePrivate(token,proRataTokens[i],claimer,UINT256_MAX,false);}}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 264
column: 4
content: functionrecycleable(addresstoken,ITokenSnapshotsproRataToken,address[]investors,uint256until)publicconstantreturns(uint256){uint256totalAmount=0;for(uint256i=0;i<investors.length;i+=1){(uint256claimableAmount,,)=claimablePrivate(token,proRataToken,investors[i],until,true);totalAmount+=claimableAmount;}returntotalAmount;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 279
column: 4
content: functionfeeDisbursalController()publicconstantreturns(IFeeDisbursalController){return_feeDisbursalController;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 458
column: 4
content: functionclaimablePrivate(addresstoken,ITokenSnapshotsproRataToken,addressclaimer,uint256until,boolonlyRecycleable)privateconstantreturns(uint256claimableAmount,uint256totalAmount,uint256nextIndex){nextIndex=min(until,_disbursals[token][proRataToken].length);uint256currentIndex=_disbursalProgress[token][proRataToken][claimer];uint256currentSnapshotId=proRataToken.currentSnapshotId();for(;currentIndex<nextIndex;currentIndex+=1){Disbursalstoragedisbursal=_disbursals[token][proRataToken][currentIndex];uint256snapshotId=disbursal.snapshotId;if(snapshotId==currentSnapshotId)break;if(onlyRecycleable&&disbursal.recycleableAfterTimestamp>block.timestamp)break;totalAmount+=disbursal.amount;claimableAmount+=calculateClaimableAmount(claimer,disbursal.amount,token,proRataToken,snapshotId);}return(claimableAmount,totalAmount,currentIndex);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 485
column: 4
content: functioncalculateClaimableAmount(addressclaimer,uint256disbursalAmount,addresstoken,ITokenSnapshotsproRataToken,uint256snapshotId)privateconstantreturns(uint256){uint256proRataClaimerBalance=proRataToken.balanceOfAt(claimer,snapshotId);if(proRataClaimerBalance==0){return0;}uint256proRataTokenTotalSupply=proRataToken.totalSupplyAt(snapshotId);if(token==address(proRataToken)){proRataTokenTotalSupply-=proRataToken.balanceOfAt(address(this),snapshotId);}returnmul(disbursalAmount,proRataClaimerBalance)/proRataTokenTotalSupply;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 139
column: 8
content: for(i=0;i<tokens.length;i+=1){require(_feeDisbursalController.onAccept(tokens[i],proRataToken,msg.sender),"NF_ACCEPT_REJECTED");(claimed[i][0],,claimed[i][1])=claimPrivate(tokens[i],proRataToken,msg.sender,UINT256_MAX);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 145
column: 8
content: for(i=0;i<tokens.length;i+=1){if(claimed[i][0]>0){IERC223Tokenierc223Token=IERC223Token(tokens[i]);assert(ierc223Token.transfer(msg.sender,claimed[i][0],""));}emitLogDisbursalAccepted(msg.sender,tokens[i],proRataToken,claimed[i][0],claimed[i][1]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 162
column: 8
content: for(i=0;i<proRataTokens.length;i+=1){require(_feeDisbursalController.onAccept(token,proRataTokens[i],msg.sender),"NF_ACCEPT_REJECTED");(uint256amount,,uint256nextIndex)=claimPrivate(token,proRataTokens[i],msg.sender,UINT256_MAX);fullAmount+=amount;emitLogDisbursalAccepted(msg.sender,token,proRataTokens[i],amount,nextIndex);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 213
column: 8
content: for(uint256i=0;i<tokens.length;i+=1){claimables[i][3]=_disbursalProgress[tokens[i]][proRataToken][claimer];if(claimables[i][3]<_disbursals[tokens[i]][proRataToken].length){claimables[i][2]=_disbursals[tokens[i]][proRataToken][claimables[i][3]].recycleableAfterTimestamp;}(claimables[i][0],claimables[i][1],)=claimablePrivate(tokens[i],proRataToken,claimer,UINT256_MAX,false);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 229
column: 8
content: for(uint256i=0;i<proRataTokens.length;i+=1){claimables[i][3]=_disbursalProgress[token][proRataTokens[i]][claimer];if(claimables[i][3]<_disbursals[token][proRataTokens[i]].length){claimables[i][2]=_disbursals[token][proRataTokens[i]][claimables[i][3]].recycleableAfterTimestamp;}(claimables[i][0],claimables[i][1],)=claimablePrivate(token,proRataTokens[i],claimer,UINT256_MAX,false);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 246
column: 8
content: for(uint256i=0;i<investors.length;i+=1){(uint256claimableAmount,,uint256nextIndex)=claimablePrivate(token,ITokenSnapshots(proRataToken),investors[i],until,true);totalClaimableAmount+=claimableAmount;_disbursalProgress[token][proRataToken][investors[i]]=nextIndex;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 271
column: 8
content: for(uint256i=0;i<investors.length;i+=1){(uint256claimableAmount,,)=claimablePrivate(token,proRataToken,investors[i],until,true);totalAmount+=claimableAmount;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: k4o1l4
severity: 1
line: 97
column: 8
content: while(_disbursals[token][proRataToken][ii-1].snapshotId==snapshotId&&--ii>0){}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 139
column: 8
content: for(i=0;i<tokens.length;i+=1){require(_feeDisbursalController.onAccept(tokens[i],proRataToken,msg.sender),"NF_ACCEPT_REJECTED");(claimed[i][0],,claimed[i][1])=claimPrivate(tokens[i],proRataToken,msg.sender,UINT256_MAX);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 145
column: 8
content: for(i=0;i<tokens.length;i+=1){if(claimed[i][0]>0){IERC223Tokenierc223Token=IERC223Token(tokens[i]);assert(ierc223Token.transfer(msg.sender,claimed[i][0],""));}emitLogDisbursalAccepted(msg.sender,tokens[i],proRataToken,claimed[i][0],claimed[i][1]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 162
column: 8
content: for(i=0;i<proRataTokens.length;i+=1){require(_feeDisbursalController.onAccept(token,proRataTokens[i],msg.sender),"NF_ACCEPT_REJECTED");(uint256amount,,uint256nextIndex)=claimPrivate(token,proRataTokens[i],msg.sender,UINT256_MAX);fullAmount+=amount;emitLogDisbursalAccepted(msg.sender,token,proRataTokens[i],amount,nextIndex);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 213
column: 8
content: for(uint256i=0;i<tokens.length;i+=1){claimables[i][3]=_disbursalProgress[tokens[i]][proRataToken][claimer];if(claimables[i][3]<_disbursals[tokens[i]][proRataToken].length){claimables[i][2]=_disbursals[tokens[i]][proRataToken][claimables[i][3]].recycleableAfterTimestamp;}(claimables[i][0],claimables[i][1],)=claimablePrivate(tokens[i],proRataToken,claimer,UINT256_MAX,false);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 229
column: 8
content: for(uint256i=0;i<proRataTokens.length;i+=1){claimables[i][3]=_disbursalProgress[token][proRataTokens[i]][claimer];if(claimables[i][3]<_disbursals[token][proRataTokens[i]].length){claimables[i][2]=_disbursals[token][proRataTokens[i]][claimables[i][3]].recycleableAfterTimestamp;}(claimables[i][0],claimables[i][1],)=claimablePrivate(token,proRataTokens[i],claimer,UINT256_MAX,false);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 246
column: 8
content: for(uint256i=0;i<investors.length;i+=1){(uint256claimableAmount,,uint256nextIndex)=claimablePrivate(token,ITokenSnapshots(proRataToken),investors[i],until,true);totalClaimableAmount+=claimableAmount;_disbursalProgress[token][proRataToken][investors[i]]=nextIndex;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 271
column: 8
content: for(uint256i=0;i<investors.length;i+=1){(uint256claimableAmount,,)=claimablePrivate(token,proRataToken,investors[i],until,true);totalAmount+=claimableAmount;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 97
column: 14
content: _disbursals[token][proRataToken][ii-1].snapshotId==snapshotId&&--ii>0

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 28
column: 13
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 31
column: 12
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 38
column: 28
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 40
column: 57
content: private

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 444
column: 12
content: (uint256claimedAmount,uint256totalAmount,uint256nextIndex)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 461
column: 16
content: (uint256claimableAmount,uint256totalAmount,uint256nextIndex)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 91h3sa
severity: 1
line: 351
column: 8
content: public

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 133
column: 35
content: address[]tokens

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 157
column: 57
content: ITokenSnapshots[]proRataTokens

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 207
column: 37
content: address[]tokens

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 210
column: 13
content: uint256[4][]claimables

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 223
column: 59
content: ITokenSnapshots[]proRataTokens

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 226
column: 13
content: uint256[4][]claimables

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 239
column: 66
content: address[]investors

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 264
column: 70
content: address[]investors

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 299
column: 59
content: bytesdata

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 306
column: 81
content: bytesdata

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 362
column: 81
content: bytesdata

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 43
column: 4
content: mapping(address=>mapping(address=>mapping(address=>uint256)))_disbursalProgress;

SOLIDITY_VISIBILITY :1
SOLIDITY_DEPRECATED_CONSTRUCTIONS :10
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :4
SOLIDITY_EXTRA_GAS_IN_LOOPS :8
SOLIDITY_ADDRESS_HARDCODED :3
SOLIDITY_UPGRADE_TO_050 :12
SOLIDITY_GAS_LIMIT_IN_LOOPS :8
SOLIDITY_SHOULD_RETURN_STRUCT :2
