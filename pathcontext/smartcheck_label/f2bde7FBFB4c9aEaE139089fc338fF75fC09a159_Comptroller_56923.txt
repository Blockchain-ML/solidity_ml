C:\Users\hp\DataSet\contracts\ropsten\f2\f2bde7FBFB4c9aEaE139089fc338fF75fC09a159_Comptroller.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 2465
column: 8
content: pendingComptrollerImplementation=address(0)

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 2519
column: 8
content: pendingAdmin=address(0)

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 2764
column: 8
content: storedList.length--

ruleId: SOLIDITY_ERC20_APPROVE
patternId: af782c
severity: 2
line: 1092
column: 4
content: functionapprove(addressspender,uint256amount)externalreturns(bool){addresssrc=msg.sender;transferAllowances[src][spender]=amount;emitApproval(src,spender,amount);returntrue;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 3197
column: 8
content: for(uinti=0;i<assets.length;i++){CTokenasset=assets[i];(oErr,vars.cTokenBalance,vars.borrowBalance,vars.exchangeRateMantissa)=asset.getAccountSnapshot(account);if(oErr!=0){return(Error.SNAPSHOT_ERROR,0,0);}vars.collateralFactor=Exp({mantissa:markets[address(asset)].collateralFactorMantissa});vars.exchangeRate=Exp({mantissa:vars.exchangeRateMantissa});vars.oraclePriceMantissa=oracle.getUnderlyingPrice(asset);if(vars.oraclePriceMantissa==0){return(Error.PRICE_ERROR,0,0);}vars.oraclePrice=Exp({mantissa:vars.oraclePriceMantissa});(mErr,vars.tokensToEther)=mulExp3(vars.collateralFactor,vars.exchangeRate,vars.oraclePrice);if(mErr!=MathError.NO_ERROR){return(Error.MATH_ERROR,0,0);}(mErr,vars.sumCollateral)=mulScalarTruncateAddUInt(vars.tokensToEther,vars.cTokenBalance,vars.sumCollateral);if(mErr!=MathError.NO_ERROR){return(Error.MATH_ERROR,0,0);}(mErr,vars.sumBorrowPlusEffects)=mulScalarTruncateAddUInt(vars.oraclePrice,vars.borrowBalance,vars.sumBorrowPlusEffects);if(mErr!=MathError.NO_ERROR){return(Error.MATH_ERROR,0,0);}if(asset==cTokenModify){(mErr,vars.sumBorrowPlusEffects)=mulScalarTruncateAddUInt(vars.tokensToEther,redeemTokens,vars.sumBorrowPlusEffects);if(mErr!=MathError.NO_ERROR){return(Error.MATH_ERROR,0,0);}(mErr,vars.sumBorrowPlusEffects)=mulScalarTruncateAddUInt(vars.oraclePrice,borrowAmount,vars.sumBorrowPlusEffects);if(mErr!=MathError.NO_ERROR){return(Error.MATH_ERROR,0,0);}}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 2674
column: 8
content: for(uinti=0;i<len;i++){CTokencToken=CToken(cTokens[i]);MarketstoragemarketToJoin=markets[address(cToken)];if(!marketToJoin.isListed){results[i]=uint(Error.MARKET_NOT_LISTED);continue;}if(marketToJoin.accountMembership[msg.sender]==true){results[i]=uint(Error.NO_ERROR);continue;}if(accountAssets[msg.sender].length>=maxAssets){results[i]=uint(Error.TOO_MANY_ASSETS);continue;}marketToJoin.accountMembership[msg.sender]=true;accountAssets[msg.sender].push(cToken);emitMarketEntered(cToken,msg.sender);results[i]=uint(Error.NO_ERROR);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 2751
column: 8
content: for(uinti=0;i<len;i++){if(userAssetList[i]==cToken){assetIndex=i;break;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 3197
column: 8
content: for(uinti=0;i<assets.length;i++){CTokenasset=assets[i];(oErr,vars.cTokenBalance,vars.borrowBalance,vars.exchangeRateMantissa)=asset.getAccountSnapshot(account);if(oErr!=0){return(Error.SNAPSHOT_ERROR,0,0);}vars.collateralFactor=Exp({mantissa:markets[address(asset)].collateralFactorMantissa});vars.exchangeRate=Exp({mantissa:vars.exchangeRateMantissa});vars.oraclePriceMantissa=oracle.getUnderlyingPrice(asset);if(vars.oraclePriceMantissa==0){return(Error.PRICE_ERROR,0,0);}vars.oraclePrice=Exp({mantissa:vars.oraclePriceMantissa});(mErr,vars.tokensToEther)=mulExp3(vars.collateralFactor,vars.exchangeRate,vars.oraclePrice);if(mErr!=MathError.NO_ERROR){return(Error.MATH_ERROR,0,0);}(mErr,vars.sumCollateral)=mulScalarTruncateAddUInt(vars.tokensToEther,vars.cTokenBalance,vars.sumCollateral);if(mErr!=MathError.NO_ERROR){return(Error.MATH_ERROR,0,0);}(mErr,vars.sumBorrowPlusEffects)=mulScalarTruncateAddUInt(vars.oraclePrice,vars.borrowBalance,vars.sumBorrowPlusEffects);if(mErr!=MathError.NO_ERROR){return(Error.MATH_ERROR,0,0);}if(asset==cTokenModify){(mErr,vars.sumBorrowPlusEffects)=mulScalarTruncateAddUInt(vars.tokensToEther,redeemTokens,vars.sumBorrowPlusEffects);if(mErr!=MathError.NO_ERROR){return(Error.MATH_ERROR,0,0);}(mErr,vars.sumBorrowPlusEffects)=mulScalarTruncateAddUInt(vars.oraclePrice,borrowAmount,vars.sumBorrowPlusEffects);if(mErr!=MathError.NO_ERROR){return(Error.MATH_ERROR,0,0);}}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 2405
column: 0
content: contractUnitrollerisUnitrollerAdminStorage,ComptrollerErrorReporter{eventNewPendingImplementation(addressoldPendingImplementation,addressnewPendingImplementation);eventNewImplementation(addressoldImplementation,addressnewImplementation);eventNewPendingAdmin(addressoldPendingAdmin,addressnewPendingAdmin);eventNewAdmin(addressoldAdmin,addressnewAdmin);constructor()public{admin=msg.sender;}function_setPendingImplementation(addressnewPendingImplementation)publicreturns(uint){if(msg.sender!=admin){returnfail(Error.UNAUTHORIZED,FailureInfo.SET_PENDING_IMPLEMENTATION_OWNER_CHECK);}addressoldPendingImplementation=pendingComptrollerImplementation;pendingComptrollerImplementation=newPendingImplementation;emitNewPendingImplementation(oldPendingImplementation,pendingComptrollerImplementation);returnuint(Error.NO_ERROR);}function_acceptImplementation()publicreturns(uint){if(msg.sender!=pendingComptrollerImplementation||pendingComptrollerImplementation==address(0)){returnfail(Error.UNAUTHORIZED,FailureInfo.ACCEPT_PENDING_IMPLEMENTATION_ADDRESS_CHECK);}addressoldImplementation=comptrollerImplementation;addressoldPendingImplementation=pendingComptrollerImplementation;comptrollerImplementation=pendingComptrollerImplementation;pendingComptrollerImplementation=address(0);emitNewImplementation(oldImplementation,comptrollerImplementation);emitNewPendingImplementation(oldPendingImplementation,pendingComptrollerImplementation);returnuint(Error.NO_ERROR);}function_setPendingAdmin(addressnewPendingAdmin)publicreturns(uint){if(msg.sender!=admin){returnfail(Error.UNAUTHORIZED,FailureInfo.SET_PENDING_ADMIN_OWNER_CHECK);}addressoldPendingAdmin=pendingAdmin;pendingAdmin=newPendingAdmin;emitNewPendingAdmin(oldPendingAdmin,newPendingAdmin);returnuint(Error.NO_ERROR);}function_acceptAdmin()publicreturns(uint){if(msg.sender!=pendingAdmin||msg.sender==address(0)){returnfail(Error.UNAUTHORIZED,FailureInfo.ACCEPT_ADMIN_PENDING_ADMIN_CHECK);}addressoldAdmin=admin;addressoldPendingAdmin=pendingAdmin;admin=pendingAdmin;pendingAdmin=address(0);emitNewAdmin(oldAdmin,admin);emitNewPendingAdmin(oldPendingAdmin,pendingAdmin);returnuint(Error.NO_ERROR);}function()payableexternal{(boolsuccess,)=comptrollerImplementation.delegatecall(msg.data);assembly{letfree_mem_ptr:=mload(0x40)returndatacopy(free_mem_ptr,0,returndatasize)switchsuccesscase0{revert(free_mem_ptr,returndatasize)}default{return(free_mem_ptr,returndatasize)}}}}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 5
column: 16
content: ^

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 720
column: 12
content: private

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 78
column: 48
content: (uint,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 305
column: 59
content: (MathError,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 322
column: 59
content: (MathError,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 333
column: 59
content: (MathError,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 344
column: 59
content: (MathError,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 357
column: 74
content: (MathError,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 389
column: 64
content: (MathError,Expmemory)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 406
column: 70
content: (MathError,Expmemory)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 415
column: 70
content: (MathError,Expmemory)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 424
column: 72
content: (MathError,Expmemory)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 436
column: 80
content: (MathError,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 448
column: 100
content: (MathError,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 460
column: 72
content: (MathError,Expmemory)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 472
column: 83
content: (MathError,Expmemory)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 492
column: 91
content: (MathError,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 504
column: 70
content: (MathError,Expmemory)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 529
column: 58
content: (MathError,Expmemory)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 536
column: 85
content: (MathError,Expmemory)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 549
column: 70
content: (MathError,Expmemory)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 761
column: 89
content: (uint,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 1137
column: 71
content: (uint,uint,uint,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 1240
column: 80
content: (MathError,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 1297
column: 64
content: (MathError,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 3157
column: 70
content: (uint,uint,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 3169
column: 80
content: (Error,uint,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 3189
column: 49
content: (Error,uint,uint)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 3267
column: 133
content: (uint,uint)

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 3528
column: 16
content: tx.origin

ruleId: SOLIDITY_UNCHECKED_CALL
patternId: f39eed
severity: 3
line: 2534
column: 53
content: delegatecall(msg.data)

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 2537
column: 8
content: assembly{letfree_mem_ptr:=mload(0x40)returndatacopy(free_mem_ptr,0,returndatasize)switchsuccesscase0{revert(free_mem_ptr,returndatasize)}default{return(free_mem_ptr,returndatasize)}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 1583
column: 4
content: functionredeemFresh(addresspayable

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 376
column: 4
content: uintconstantexpScale=1e18;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 377
column: 4
content: uintconstanthalfExpScale=expScale/2;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 378
column: 4
content: uintconstantmantissaOne=expScale;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 800
column: 4
content: uintconstantborrowRateMaxMantissa=5e14;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 805
column: 4
content: uintconstantreserveFactorMaxMantissa=1e18;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 865
column: 4
content: mapping(address=>uint256)accountTokens;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 870
column: 4
content: mapping(address=>mapping(address=>uint256))transferAllowances;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 885
column: 4
content: mapping(address=>BorrowSnapshot)accountBorrows;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1583
column: 41
content: redeemer,

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1583
column: 51
content: uintredeemTokensIn,

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1583
column: 72
content: uintredeemAmountIn)internalreturns

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1583
column: 110
content: (uint){require

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1584
column: 15
content: (redeemTokensIn==0||redeemAmountIn==0,"one of redeemTokensIn or redeemAmountIn must be zero");

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1586
column: 8
content: RedeemLocalVarsmemoryvars;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1589
column: 8
content: (vars.mathErr,vars.

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1589
column: 28
content: exchangeRateMantissa)=

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1589
column: 52
content: exchangeRateStoredInternal

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1589
column: 78
content: ();if

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1590
column: 11
content: (vars.mathErr!=MathError.

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1590
column: 38
content: NO_ERROR){return

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1591
column: 19
content: failOpaque(Error.

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1591
column: 36
content: MATH_ERROR,FailureInfo.

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1591
column: 60
content: REDEEM_EXCHANGE_RATE_READ_FAILED,

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1591
column: 94
content: uint(vars.

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1591
column: 104
content: mathErr));

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2624
column: 4
content: uintconstantcloseFactorMinMantissa=5e16;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2627
column: 4
content: uintconstantcloseFactorMaxMantissa=9e17;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2630
column: 4
content: uintconstantcollateralFactorMaxMantissa=9e17;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2633
column: 4
content: uintconstantliquidationIncentiveMinMantissa=mantissaOne;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2636
column: 4
content: uintconstantliquidationIncentiveMaxMantissa=15e17;

SOLIDITY_VISIBILITY :31
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_ARRAY_LENGTH_MANIPULATION :1
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :1
SOLIDITY_EXTRA_GAS_IN_LOOPS :1
SOLIDITY_ADDRESS_HARDCODED :2
SOLIDITY_GAS_LIMIT_IN_LOOPS :3
SOLIDITY_UNCHECKED_CALL :1
SOLIDITY_SHOULD_RETURN_STRUCT :27
SOLIDITY_TX_ORIGIN :1
SOLIDITY_ERC20_APPROVE :1
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_USING_INLINE_ASSEMBLY :1
