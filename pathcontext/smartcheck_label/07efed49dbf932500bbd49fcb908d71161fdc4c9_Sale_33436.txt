C:\Users\hp\DataSet\contracts\ropsten\07\07efed49dbf932500bbd49fcb908d71161fdc4c9_Sale.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 45
column: 4
content: owner=address(0)

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 412
column: 8
content: for(uinti=1;i<purchasedList.length;i++){if(purchasedList[i].product==_product&&purchasedList[i].buyer==_buyer){returnpurchasedList[i].id;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 436
column: 8
content: for(uinti=1;i<purchasedList.length;i++){if(isLive(i)&&(purchasedList[i].product==_product)){if(succeed<_count){Productproduct=Product(purchasedList[i].product);require(block.timestamp>=criterionTime.add(product.lockup()*1days));require(token.balanceOf(address(this))>=purchasedList[i].amount);purchasedList[i].release=true;token.safeTransfer(purchasedList[i].buyer,purchasedList[i].amount);succeed=succeed.add(1);emitReceipt(purchasedList[i].buyer,purchasedList[i].product,purchasedList[i].id,purchasedList[i].amount,purchasedList[i].release,purchasedList[i].refund);}else{remainder=remainder.add(1);}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 747
column: 4
content: for(uint256i=0;i<addrs.length;i++){addAddressToWhitelist(addrs[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 776
column: 4
content: for(uint256i=0;i<addrs.length;i++){removeAddressFromWhitelist(addrs[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 747
column: 4
content: for(uint256i=0;i<addrs.length;i++){addAddressToWhitelist(addrs[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 776
column: 4
content: for(uint256i=0;i<addrs.length;i++){removeAddressFromWhitelist(addrs[i]);}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 809
column: 0
content: contractSaleisStateable{usingSafeMathforuint256;usingMathforuint256;addresspublicwallet;WhitelistpublicwhiteList;Productpublicproduct;TokenDistributorpublictokenDistributor;mapping(string=>bool)isRegistered;mapping(string=>mapping(address=>uint256))privatebuyers;modifiervalidAddress(address_account){require(_account!=address(0));require(_account!=address(this));_;}modifiervalidProductName(string_productName){require(bytes(_productName).length!=0);_;}modifierchangeProduct(){require(getState()==State.Unknown||getState()==State.Preparing||getState()==State.Finished);_;}constructor(address_wallet,address_whiteList,address_tokenDistributor)public{require(_wallet!=address(0));require(_whiteList!=address(0));require(_tokenDistributor!=address(0));wallet=_wallet;whiteList=Whitelist(_whiteList);tokenDistributor=TokenDistributor(_tokenDistributor);}functionregisterProduct(address_product)externalonlyOwnerchangeProductvalidAddress(_product){product=Product(_product);require(!isRegistered[product.name()]);isRegistered[product.name()]=true;setState(State.Preparing);emitChangeExternalAddress(_product,"Product");}functionsetTokenDistributor(address_tokenDistributor)externalonlyOwnervalidAddress(_tokenDistributor){tokenDistributor=TokenDistributor(_tokenDistributor);emitChangeExternalAddress(_tokenDistributor,"TokenDistributor");}functionsetWhitelist(address_whitelist)externalonlyOwnervalidAddress(_whitelist){whiteList=Whitelist(_whitelist);emitChangeExternalAddress(_whitelist,"Whitelist");}functionsetWallet(address_wallet)externalonlyOwnervalidAddress(_wallet){wallet=_wallet;emitChangeExternalAddress(_wallet,"Wallet");}functionpause()externalonlyOwner{require(getState()==State.Starting);setState(State.Pausing);}functionstart()externalonlyOwner{require(getState()==State.Preparing||getState()==State.Pausing);setState(State.Starting);}functionfinish()externalonlyOwner{setState(State.Finished);}function()externalpayable{addressbuyer=msg.sender;uint256amount=msg.value;require(getState()==State.Starting);require(whiteList.whitelist(buyer));require(buyer!=address(0));require(product.weiRaised()<product.maxcap());addressproductAddress=address(product);uint256tokenAmount=tokenDistributor.getAmount(buyers[product.name()][buyer]);uint256buyerAmount=(tokenAmount>0)?tokenAmount.div(product.rate()):0;require(buyerAmount<product.exceed());require(buyerAmount.add(amount)>=product.minimum());uint256purchase;uint256refund;uint256totalAmount;(purchase,refund,totalAmount)=getPurchaseDetail(buyerAmount,amount);product.setWeiRaised(totalAmount);if(buyerAmount>0){tokenDistributor.addPurchased(buyers[product.name()][buyer],purchase.mul(product.rate()));}else{buyers[product.name()][buyer]=tokenDistributor.setPurchased(buyer,productAddress,purchase.mul(product.rate()));}wallet.transfer(purchase);if(refund>0){buyer.transfer(refund);}if(totalAmount>=product.maxcap()){setState(State.Finished);}emitPurchase(buyer,purchase,refund,purchase.mul(product.rate()));}functiongetPurchaseDetail(uint256_buyerAmount,uint256_amount)privateviewreturns(uint256,uint256,uint256){uint256d1=product.maxcap().sub(product.weiRaised());uint256d2=product.exceed().sub(_buyerAmount);uint256possibleAmount=(d1.min256(d2)).min256(_amount);return(possibleAmount,_amount.sub(possibleAmount),possibleAmount.add(product.weiRaised()));}functionrefund(string_productName,address_buyerAddress)externalonlyOwnervalidProductName(_productName)validAddress(_buyerAddress){require(buyers[_productName][_buyerAddress]>0);boolisRefund;uint256refundToken;(isRefund,refundToken)=tokenDistributor.refund(buyers[_productName][_buyerAddress]);require(refundToken>0);if(isRefund){product.subWeiRaised(refundToken.div(product.rate()));deletebuyers[_productName][_buyerAddress];}}functionbuyerAddressTransfer(string_productName,address_from,address_to)externalonlyOwnervalidProductName(_productName)validAddress(_from)validAddress(_to){require(whiteList.whitelist(_from));require(whiteList.whitelist(_to));require(tokenDistributor.getAmount(buyers[_productName][_from])>0);require(tokenDistributor.getAmount(buyers[_productName][_to])==0);boolisChanged=tokenDistributor.buyerAddressTransfer(buyers[_productName][_from],_from,_to);require(isChanged);uint256fromId=buyers[_productName][_from];buyers[_productName][_to]=fromId;deletebuyers[_productName][_from];emitBuyerAddressTransfer(_from,_to,buyers[_productName][_to]);}eventPurchase(addressindexed_buyer,uint256_purchased,uint256_refund,uint256_tokens);eventChangeExternalAddress(address_addr,string_name);eventBuyerAddressTransfer(addressindexed_from,addressindexed_to,uint256_id);}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 236
column: 4
content: functionsetWeiRaised(uint256_weiRaised)externalonlyOwner{require(weiRaised<=_weiRaised);weiRaised=_weiRaised;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 369
column: 4
content: functionsetPurchased(address_buyer,address_product,uint256_amount)externalonlyOwnervalidAddress(_buyer)validAddress(_product)returns(uint256){index=index.add(1);purchasedList.push(Purchased(_buyer,_product,index,_amount,false,false));returnindex;emitReceipt(_buyer,_product,index,_amount,false,false);}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 421
column: 4
content: functionsetCriterionTime(uint256_criterionTime)externalonlyOwner{require(_criterionTime>0);criterionTime=_criterionTime;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 862
column: 4
content: functionsetTokenDistributor(address_tokenDistributor)externalonlyOwnervalidAddress(_tokenDistributor){tokenDistributor=TokenDistributor(_tokenDistributor);emitChangeExternalAddress(_tokenDistributor,"TokenDistributor");}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 867
column: 4
content: functionsetWhitelist(address_whitelist)externalonlyOwnervalidAddress(_whitelist){whiteList=Whitelist(_whitelist);emitChangeExternalAddress(_whitelist,"Whitelist");}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 872
column: 4
content: functionsetWallet(address_wallet)externalonlyOwnervalidAddress(_wallet){wallet=_wallet;emitChangeExternalAddress(_wallet,"Wallet");}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 330
column: 16
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 331
column: 12
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 602
column: 33
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 819
column: 53
content: private

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 208
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 317
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 810
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 936
column: 91
content: (uint256,uint256,uint256)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 108
column: 62
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 219
column: 8
content: string_name

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 613
column: 35
content: stringroleName

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 626
column: 33
content: stringroleName

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 639
column: 33
content: stringroleName

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 651
column: 36
content: stringroleName

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 743
column: 35
content: address[]addrs

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 772
column: 40
content: address[]addrs

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 71
column: 4
content: Statestate;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 121
column: 4
content: mapping(address=>bool)owners;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 329
column: 4
content: ERC20token;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 818
column: 4
content: mapping(string=>bool)isRegistered;

SOLIDITY_VISIBILITY :4
SOLIDITY_SAFEMATH :3
SOLIDITY_OVERPOWERED_ROLE :6
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :4
SOLIDITY_EXTRA_GAS_IN_LOOPS :4
SOLIDITY_ADDRESS_HARDCODED :1
SOLIDITY_UPGRADE_TO_050 :8
SOLIDITY_GAS_LIMIT_IN_LOOPS :2
SOLIDITY_SHOULD_RETURN_STRUCT :1
