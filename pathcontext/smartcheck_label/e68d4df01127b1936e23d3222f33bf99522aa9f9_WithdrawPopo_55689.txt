C:\Users\hp\DataSet\contracts\ropsten\e6\e68d4df01127b1936e23d3222f33bf99522aa9f9_WithdrawPopo.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 116
column: 28
content: 0x20

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 116
column: 61
content: 0x20

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 118
column: 24
content: 0x30

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 120
column: 32
content: 0x78

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 121
column: 32
content: 0x58

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 131
column: 27
content: 0x40

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 131
column: 46
content: 0x5b

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 143
column: 32
content: 0x20

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 145
column: 32
content: 0x60

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 145
column: 51
content: 0x7b

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 147
column: 32
content: 0x2f

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 147
column: 51
content: 0x3a

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 151
column: 32
content: 0x20

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 152
column: 47
content: 0x20

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 155
column: 58
content: 0x30

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 155
column: 77
content: 0x39

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 552
column: 4
content: for(uint256_index=0;_index<_oIDs.length;_index=_index.add(1)){PopoDatasets.Ordermemory_order=oID_Order_[_oIDs[_index]];_orderValue=_orderValue.add(_order.orderValue);_actualTotalRefund=_actualTotalRefund.add(getOrderActualTotalRefundHelper(_nowDayIndex,_oIDs[_index]));}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: k4o1l4
severity: 1
line: 409
column: 4
content: while((_pot>0)&&(refundOIDIndex_<refundOIDs_.length)){(_pot,refundOIDIndex_)=doRefund(_nowDayIndex,refundOIDIndex_,_pot);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 128
column: 8
content: for(uint256i=0;i<_length;i=i.add(1)){if(_temp[i]>0x40&&_temp[i]<0x5b){_temp[i]=byte(uint(_temp[i])+32);if(_hasNonNumber==false)_hasNonNumber=true;}else{require(_temp[i]==0x20||(_temp[i]>0x60&&_temp[i]<0x7b)||(_temp[i]>0x2f&&_temp[i]<0x3a),"string contains invalid characters");if(_temp[i]==0x20)require(_temp[i.add(1)]!=0x20,"string cannot contain consecutive spaces");if(_hasNonNumber==false&&(_temp[i]<0x30||_temp[i]>0x39))_hasNonNumber=true;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 552
column: 4
content: for(uint256_index=0;_index<_oIDs.length;_index=_index.add(1)){PopoDatasets.Ordermemory_order=oID_Order_[_oIDs[_index]];_orderValue=_orderValue.add(_order.orderValue);_actualTotalRefund=_actualTotalRefund.add(getOrderActualTotalRefundHelper(_nowDayIndex,_oIDs[_index]));}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 411
column: 6
content: (_pot>0)&&(refundOIDIndex_<refundOIDs_.length)

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 170
column: 0
content: contractCorePopo{usingSafeMathfor*;uint256publicactivated_time_;uint256publicstartTime_;uint256publicteamPot_;uint256publiccommunityPot_;mapping(uint256=>uint256)publicday_ethIn;uint256publicethIn_;uint256publicdayEthInLimit_=300ether;uint256publicplayerDayEthInLimit_=10ether;uint256publicpIDIndex_;mapping(uint256=>PopoDatasets.Player)publicpID_Player_;mapping(address=>uint256)publicaddr_pID_;mapping(bytes32=>uint256)publicname_pID_;mapping(uint256=>uint256)publicinviteePID_inviteReward1_;uint256publicoIDIndex_;mapping(uint256=>PopoDatasets.Order)publicoID_Order_;uint256[]publicrefundOIDs_;uint256publicrefundOIDIndex_;functiondeterminePID()internal{if(addr_pID_[msg.sender]!=0){return;}pIDIndex_=pIDIndex_.add(1);pID_Player_[pIDIndex_].addr=msg.sender;addr_pID_[msg.sender]=pIDIndex_;}functiongetDayIndex(uint256_time)internalviewreturns(uint256){return_time.sub(activated_time_).div(1days).add(1);}usingNameFilterforstring;functionenableInvite(string_nameString,bytes32_inviterName)publicpayable{require(msg.value==0.01ether,"enable invite need 0.01 ether");determinePID();determineInviter(addr_pID_[msg.sender],_inviterName);require(pID_Player_[addr_pID_[msg.sender]].inviteEnable==false,"you can only enable invite once");bytes32_name=_nameString.nameFilter();require(name_pID_[_name]==0,"your name is already registered by others");pID_Player_[addr_pID_[msg.sender]].name=_name;pID_Player_[addr_pID_[msg.sender]].inviteEnable=true;name_pID_[_name]=addr_pID_[msg.sender];communityPot_=communityPot_.add(msg.value);}functionenableInviteOfSU(string_nameString)public{determinePID();require(pID_Player_[addr_pID_[msg.sender]].inviteEnable==false,"you can only enable invite once");bytes32_name=_nameString.nameFilter();require(name_pID_[_name]==0,"your name is already registered by others");name_pID_[_name]=addr_pID_[msg.sender];pID_Player_[addr_pID_[msg.sender]].name=_name;pID_Player_[addr_pID_[msg.sender]].inviteEnable=true;}functiondetermineInviter(uint256_pID,bytes32_inviterName)internal{if(pID_Player_[_pID].inviterPID!=0){return;}uint256_inviterPID=name_pID_[_inviterName];require(_inviterPID!=0,"your inviter name must be registered");require(pID_Player_[_inviterPID].inviteEnable==true,"your inviter must enable invite");require(_inviterPID!=_pID,"you can not invite yourself");pID_Player_[_pID].inviterPID=_inviterPID;}functiondistributeInviteReward(uint256_pID,uint256_inviteReward1,uint256_inviteReward2,uint256_inviteReward3,uint256_percent)internalreturns(uint256){uint256inviterPID=pID_Player_[_pID].inviterPID;if(pID_Player_[inviterPID].inviteEnable){pID_Player_[inviterPID].inviteReward1=pID_Player_[inviterPID].inviteReward1.add(_inviteReward1);if(inviteePID_inviteReward1_[_pID]==0){pID_Player_[inviterPID].inviteePIDs.push(_pID);}inviteePID_inviteReward1_[_pID]=inviteePID_inviteReward1_[_pID].add(_inviteReward1);_percent=_percent.sub(5);}uint256inviterPID_inviterPID=pID_Player_[inviterPID].inviterPID;if(pID_Player_[inviterPID_inviterPID].inviteEnable){pID_Player_[inviterPID_inviterPID].inviteReward2=pID_Player_[inviterPID_inviterPID].inviteReward2.add(_inviteReward2);_percent=_percent.sub(2);}uint256inviterPID_inviterPID_inviterPID=pID_Player_[inviterPID_inviterPID].inviterPID;if(pID_Player_[inviterPID_inviterPID_inviterPID].inviteEnable){pID_Player_[inviterPID_inviterPID_inviterPID].inviteReward3=pID_Player_[inviterPID_inviterPID_inviterPID].inviteReward3.add(_inviteReward3);_percent=_percent.sub(1);}return(_percent);}functionsetDayEthInLimit(uint256dayEthInLimit)public{dayEthInLimit_=dayEthInLimit;}functionsetPlayerDayEthInLimit(uint256playerDayEthInLimit)public{playerDayEthInLimit_=playerDayEthInLimit;}functionorder(bytes32_inviterName)publicpayable{uint256_now=now;uint256_nowDayIndex=getDayIndex(_now);require(_nowDayIndex>2,"only third day can order");determinePID();determineInviter(addr_pID_[msg.sender],_inviterName);orderCore(_now,_nowDayIndex,msg.value);}functionorderInternal(uint256_value,bytes32_inviterName)internal{uint256_now=now;uint256_nowDayIndex=getDayIndex(_now);require(_nowDayIndex>2,"only third day can order");determinePID();determineInviter(addr_pID_[msg.sender],_inviterName);orderCore(_now,_nowDayIndex,_value);}functionorderCore(uint256_now,uint256_nowDayIndex,uint256_value)private{teamPot_=teamPot_.add(_value.mul(3).div(100));communityPot_=communityPot_.add(_value.mul(4).div(100));require(day_ethIn[_nowDayIndex]<dayEthInLimit_,"beyond the day eth in limit");day_ethIn[_nowDayIndex]=day_ethIn[_nowDayIndex].add(_value);ethIn_=ethIn_.add(_value);uint256_pID=addr_pID_[msg.sender];if(pID_Player_[_pID].lastOrderDayIndex==_nowDayIndex){require(pID_Player_[_pID].dayEthIn<playerDayEthInLimit_,"beyond the player day eth in limit");pID_Player_[_pID].dayEthIn=pID_Player_[_pID].dayEthIn.add(_value);}else{pID_Player_[_pID].lastOrderDayIndex=_nowDayIndex;pID_Player_[_pID].dayEthIn=_value;}oIDIndex_=oIDIndex_.add(1);oID_Order_[oIDIndex_].pID=_pID;oID_Order_[oIDIndex_].createTime=_now;oID_Order_[oIDIndex_].createDayIndex=_nowDayIndex;oID_Order_[oIDIndex_].orderValue=_value;pID_Player_[_pID].oIDs.push(oIDIndex_);refundOIDs_.push(oIDIndex_);uint256_percent=33;if(pID_Player_[_pID].oIDs.length<3){_percent=distributeInviteReward(_pID,_value.mul(5).div(100),_value.mul(2).div(100),_value.mul(1).div(100),_percent);refund(_nowDayIndex,_value.mul(_percent).div(100));}else{refund(_nowDayIndex,_value.mul(_percent).div(100));}}functionrefund(uint256_nowDayIndex,uint256_pot)private{while((_pot>0)&&(refundOIDIndex_<refundOIDs_.length)){(_pot,refundOIDIndex_)=doRefund(_nowDayIndex,refundOIDIndex_,_pot);}}functiondoRefund(uint256_nowDayIndex,uint256_refundOIDIndex,uint256_pot)privatereturns(uint256,uint256){uint256_refundOID=refundOIDs_[_refundOIDIndex];uint_orderState=getOrderStateHelper(_nowDayIndex,_refundOID);if(_orderState!=1){return(_pot,_refundOIDIndex.add(1));}uint256_maxRefund=oID_Order_[_refundOID].orderValue.mul(60).div(100);if(oID_Order_[_refundOID].refund<_maxRefund){uint256_needRefund=_maxRefund.sub(oID_Order_[_refundOID].refund);if(_needRefund>_pot){oID_Order_[_refundOID].refund=oID_Order_[_refundOID].refund.add(_pot);return(0,_refundOIDIndex);}else{oID_Order_[_refundOID].refund=oID_Order_[_refundOID].refund.add(_needRefund);return(_pot.sub(_needRefund),_refundOIDIndex.add(1));}}else{return(_pot,_refundOIDIndex.add(1));}}functiongetOrderStateHelper(uint256_nowDayIndex,uint256_oID)internalviewreturns(uint){PopoDatasets.Ordermemory_order=oID_Order_[_oID];if(_order.hasWithdrawn){return(3);}else{if(_nowDayIndex<_order.createDayIndex||_nowDayIndex>_order.createDayIndex.add(5)){return(2);}else{return(1);}}}functiongetAdminDashboard()publicviewreturns(uint256,uint256){return(teamPot_,communityPot_);}functiongetDayEthIn(uint256_dayIndex)publicviewreturns(uint256){return(day_ethIn[_dayIndex]);}functiongetAddressLost(address_addr)publicviewreturns(uint256){uint256_now=now;uint256_nowDayIndex=getDayIndex(_now);uint256pID=addr_pID_[_addr];require(pID!=0,"address need to be registered");uint256_orderValue=0;uint256_actualTotalRefund=0;uint256[]memory_oIDs=pID_Player_[pID].oIDs;for(uint256_index=0;_index<_oIDs.length;_index=_index.add(1)){PopoDatasets.Ordermemory_order=oID_Order_[_oIDs[_index]];_orderValue=_orderValue.add(_order.orderValue);_actualTotalRefund=_actualTotalRefund.add(getOrderActualTotalRefundHelper(_nowDayIndex,_oIDs[_index]));}if(_orderValue>_actualTotalRefund){return(_orderValue.sub(_actualTotalRefund));}else{return(0);}}functiongetInviteInfo()publicviewreturns(bool,bytes32,uint256,bytes32,uint256,uint256,uint256,uint256){uint256_pID=addr_pID_[msg.sender];return(pID_Player_[_pID].inviteEnable,pID_Player_[_pID].name,pID_Player_[_pID].inviterPID,pID_Player_[pID_Player_[_pID].inviterPID].name,pID_Player_[_pID].inviteReward1,pID_Player_[_pID].inviteReward2,pID_Player_[_pID].inviteReward3,pID_Player_[_pID].inviteRewardWithdrawn);}functiongetInviteePIDs()publicviewreturns(uint256[]){uint256_pID=addr_pID_[msg.sender];return(pID_Player_[_pID].inviteePIDs);}functiongetInviteeInfo(uint256_inviteePID)publicviewreturns(uint256,bytes32){require(pID_Player_[_inviteePID].inviterPID==addr_pID_[msg.sender],"you must have invited this player");return(inviteePID_inviteReward1_[_inviteePID],pID_Player_[_inviteePID].name);}functiongetOrderInfo()publicviewreturns(bool,uint256[]){uint256_now=now;uint256_nowDayIndex=getDayIndex(_now);uint256_pID=addr_pID_[msg.sender];bool_isWithinPlayerDayEthInLimits=true;if((pID_Player_[_pID].lastOrderDayIndex==_nowDayIndex)&&(pID_Player_[_pID].dayEthIn>=playerDayEthInLimit_)){_isWithinPlayerDayEthInLimits=false;}return(_isWithinPlayerDayEthInLimits,pID_Player_[_pID].oIDs);}functiongetOrder(uint256_oID)publicviewreturns(uint256,uint256,uint256,uint,uint256){uint256_now=now;uint256_nowDayIndex=getDayIndex(_now);require(oID_Order_[_oID].pID==addr_pID_[msg.sender],"only owner can get its order");return(oID_Order_[_oID].createTime,oID_Order_[_oID].createDayIndex,oID_Order_[_oID].orderValue,getOrderStateHelper(_nowDayIndex,_oID),getOrderActualTotalRefundHelper(_nowDayIndex,_oID));}functiongetOverall()publicviewreturns(uint256,uint256,uint256,uint256,uint256,bool,uint256){uint256_now=now;uint256_nowDayIndex=getDayIndex(_now);uint256_tommorrow=_nowDayIndex.mul(1days).add(activated_time_);bool_isWithinDayEthInLimits=day_ethIn[_nowDayIndex]<dayEthInLimit_?true:false;return(_now,_nowDayIndex,_tommorrow,ethIn_,dayEthInLimit_,_isWithinDayEthInLimits,playerDayEthInLimit_);}functiongetOrderActualTotalRefundHelper(uint256_nowDayIndex,uint256_oID)internalviewreturns(uint256){if(oID_Order_[_oID].hasWithdrawn){return(oID_Order_[_oID].withdrawn);}uint256_actualTotalRefund=oID_Order_[_oID].orderValue.mul(60).div(100);uint256_dayGap=_nowDayIndex.sub(oID_Order_[_oID].createDayIndex);if(_dayGap>0){_dayGap=_dayGap>5?5:_dayGap;uint256_maxRefund=oID_Order_[_oID].orderValue.mul(12).mul(_dayGap).div(100);if(oID_Order_[_oID].refund<_maxRefund){_actualTotalRefund=_actualTotalRefund.add(oID_Order_[_oID].refund);}else{_actualTotalRefund=_actualTotalRefund.add(_maxRefund);}}return(_actualTotalRefund);}}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 11
column: 16
content: ^

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 93
column: 4
content: usingSafeMathfor*;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 171
column: 3
content: usingSafeMathfor*;

ruleId: SOLIDITY_SHOULD_NOT_BE_PURE
patternId: 11314f
severity: 1
line: 105
column: 4
content: functionnameFilter(string_input)internalpurereturns(bytes32){bytesmemory_temp=bytes(_input);uint256_length=_temp.length;require(_length<=32&&_length>0,"string must be between 1 and 32 characters");require(_temp[0]!=0x20&&_temp[_length.sub(1)]!=0x20,"string cannot start or end with space");if(_temp[0]==0x30){require(_temp[1]!=0x78,"string cannot start with 0x");require(_temp[1]!=0x58,"string cannot start with 0X");}bool_hasNonNumber;for(uint256i=0;i<_length;i=i.add(1)){if(_temp[i]>0x40&&_temp[i]<0x5b){_temp[i]=byte(uint(_temp[i])+32);if(_hasNonNumber==false)_hasNonNumber=true;}else{require(_temp[i]==0x20||(_temp[i]>0x60&&_temp[i]<0x7b)||(_temp[i]>0x2f&&_temp[i]<0x3a),"string contains invalid characters");if(_temp[i]==0x20)require(_temp[i.add(1)]!=0x20,"string cannot contain consecutive spaces");if(_hasNonNumber==false&&(_temp[i]<0x30||_temp[i]>0x39))_hasNonNumber=true;}}require(_hasNonNumber==true,"string cannot be only numbers");bytes32_ret;assembly{_ret:=mload(add(_temp,32))}return(_ret);}

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 421
column: 12
content: (uint256,uint256)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 105
column: 24
content: string_input

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 225
column: 25
content: string_nameString

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 249
column: 29
content: string_nameString

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 596
column: 13
content: uint256[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 624
column: 19
content: uint256[]

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 163
column: 8
content: assembly{_ret:=mload(add(_temp,32))}

SOLIDITY_SAFEMATH :2
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_EXTRA_GAS_IN_LOOPS :2
SOLIDITY_ADDRESS_HARDCODED :16
SOLIDITY_UPGRADE_TO_050 :5
SOLIDITY_GAS_LIMIT_IN_LOOPS :3
SOLIDITY_USING_INLINE_ASSEMBLY :1
SOLIDITY_SHOULD_RETURN_STRUCT :1
SOLIDITY_SHOULD_NOT_BE_PURE :1
