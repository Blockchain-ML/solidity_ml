C:\Users\hp\DataSet\contracts\ropsten\0f\0fd02286cea1e105de2c31fce9e2405e1cc2df36_PeerWalletsEngine.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 26
column: 8
content: returnaddress(0)

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 362
column: 12
content: --investedPeersAddress.length

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 421
column: 16
content: peers.length--

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 429
column: 24
content: peers.length--

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 176
column: 8
content: for(uinti=0;i<peers.length;++i)if(peers[i]==_peer)returntrue;

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 209
column: 12
content: for(uinti=0;i<exchangeGroupKeys.length;++i)amount[i]=peerTokens[_peer][exchangeGroupKeys[i]];

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 337
column: 8
content: for(uinti=0;i<investedPeersAddress.length;++i)ownership[investedPeersAddress[i]]=(peerAmount[investedPeersAddress[i]]*100)/totalInvested;

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 346
column: 8
content: for(uintj=0;j<investedPeersAddress.length;++j)for(uinti=0;i<exchangeGroupKeys.length;++i)peerTokens[investedPeersAddress[j]][exchangeGroupKeys[i]]=walletTokens[exchangeGroupKeys[i]]*ownership[investedPeersAddress[j]];

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 347
column: 12
content: for(uinti=0;i<exchangeGroupKeys.length;++i)peerTokens[investedPeersAddress[j]][exchangeGroupKeys[i]]=walletTokens[exchangeGroupKeys[i]]*ownership[investedPeersAddress[j]];

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 356
column: 8
content: for(;investedPeersAddress.length>0;){peerAmount[investedPeersAddress[0]]=0;isInvestedPeer[investedPeersAddress[0]]=0;investedPeersAddress[0]=investedPeersAddress[investedPeersAddress.length-1];deleteinvestedPeersAddress[investedPeersAddress.length-1];--investedPeersAddress.length;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 374
column: 12
content: for(uinti=0;i<exchangeGroupKeys.length;++i)ERC20(exchangeGroupKeys[i]).safeTransfer(address(this),msg.sender,walletTokens[exchangeGroupKeys[i]]);

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 400
column: 16
content: for(uinti=0;i<_peers.length;++i)peers.push(_peers[i]);

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 425
column: 16
content: for(uinti=0;i<peers.length;++i)if(peers[i]==_peer){peers[i]=peers[peers.length-1];deletepeers[peers.length-1];peers.length--;return;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 176
column: 8
content: for(uinti=0;i<peers.length;++i)if(peers[i]==_peer)returntrue;

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 209
column: 12
content: for(uinti=0;i<exchangeGroupKeys.length;++i)amount[i]=peerTokens[_peer][exchangeGroupKeys[i]];

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 337
column: 8
content: for(uinti=0;i<investedPeersAddress.length;++i)ownership[investedPeersAddress[i]]=(peerAmount[investedPeersAddress[i]]*100)/totalInvested;

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 346
column: 8
content: for(uintj=0;j<investedPeersAddress.length;++j)for(uinti=0;i<exchangeGroupKeys.length;++i)peerTokens[investedPeersAddress[j]][exchangeGroupKeys[i]]=walletTokens[exchangeGroupKeys[i]]*ownership[investedPeersAddress[j]];

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 347
column: 12
content: for(uinti=0;i<exchangeGroupKeys.length;++i)peerTokens[investedPeersAddress[j]][exchangeGroupKeys[i]]=walletTokens[exchangeGroupKeys[i]]*ownership[investedPeersAddress[j]];

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 374
column: 12
content: for(uinti=0;i<exchangeGroupKeys.length;++i)ERC20(exchangeGroupKeys[i]).safeTransfer(address(this),msg.sender,walletTokens[exchangeGroupKeys[i]]);

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 400
column: 16
content: for(uinti=0;i<_peers.length;++i)peers.push(_peers[i]);

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 425
column: 16
content: for(uinti=0;i<peers.length;++i)if(peers[i]==_peer){peers[i]=peers[peers.length-1];deletepeers[peers.length-1];peers.length--;return;}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 34
column: 1
content: contractPeerWallets{usingSafeERC20forERC20;address[]privatepeers;address[]privateinvestedPeersAddress;addressprivateleader;address[]privateexchangeGroupKeys;addressprivatewhiteListContractAddress;uint[]privatedistribution;uintprivatetotalInvested;boolprivateinvestmentLaunched;eventTotalInv(addressindexedowner,uintindexedtotalInvested,addressindexedpeerWallet);mapping(address=>uint)privateownership;mapping(address=>uint8)privateisInvestedPeer;mapping(address=>uint)privatepeerAmount;mapping(address=>mapping(address=>uint))privatepeerTokens;mapping(address=>uint)privatewalletTokens;functiongetPeers()publicviewreturns(address[]){returnpeers;}functiongetExchangeGroupsKeyAt(uint_index)publicviewreturns(address){returnexchangeGroupKeys[_index];}functiongetExchangeGroupsLength()publicviewreturns(uint){returnexchangeGroupKeys.length;}functiongetDistributionAt(uint_index)publicviewreturns(uint){returndistribution[_index];}functionvalidatePeer(address_peer)publicviewreturns(bool){for(uinti=0;i<peers.length;++i)if(peers[i]==_peer)returntrue;returnfalse;}functiongetPeerOwnership(address_peer)publicviewreturns(uint){if(validatePeer(_peer)==true)returnownership[_peer];return0;}functiongetPeerTokens(address_peer)publicviewreturns(uint[]){uint[]memoryamount;if(validatePeer(_peer)==true){for(uinti=0;i<exchangeGroupKeys.length;++i)amount[i]=peerTokens[_peer][exchangeGroupKeys[i]];}returnamount;}functioncreatePeerWallet(address_leader,address[]_peers,address[]_exchangeGroupKeys,uint[]_distribution)publicpayablereturns(address){leader=_leader;totalInvested=msg.value;peerAmount[leader]=totalInvested;if(totalInvested>0){investedPeersAddress.push(leader);isInvestedPeer[leader]=1;}peers=_peers;distribution=_distribution;exchangeGroupKeys=_exchangeGroupKeys;investmentLaunched=false;returnthis;}functionlaunchInvestment(uint_amount)public{if(leader==msg.sender){if(isInvestedPeer[msg.sender]==0){investedPeersAddress.push(msg.sender);isInvestedPeer[msg.sender]=1;}investmentLaunched=true;peerAmount[msg.sender]+=_amount;totalInvested+=peerAmount[msg.sender];}}functionmakeInvestment(uint_amount)public{addressowner=msg.sender;if(validatePeer(owner)==true){if(isInvestedPeer[owner]==0){investedPeersAddress.push(owner);isInvestedPeer[owner]=1;}peerAmount[owner]+=_amount;totalInvested+=peerAmount[msg.sender];addresspeerWallet=address(this);if(investmentLaunched==true){if(investedPeersAddress.length==peers.length){emitTotalInv(owner,totalInvested,peerWallet);}}else{emitTotalInv(owner,peerAmount[owner],peerWallet);}}}functiontriggerInvestment()public{if(leader==msg.sender&&totalInvested>0){addresspeerWallet=address(this);emitTotalInv(leader,totalInvested,peerWallet);}}functioncompleteInvestment()publicreturns(bool){distributeOwnership();distributePeerTokens();resetPeerWallet();returntrue;}functiontradeWalletTokens(address_exchangeGroupKey,uint_tokens)public{walletTokens[_exchangeGroupKey]=_tokens;}functiondistributeOwnership()private{for(uinti=0;i<investedPeersAddress.length;++i)ownership[investedPeersAddress[i]]=(peerAmount[investedPeersAddress[i]]*100)/totalInvested;}functiondistributePeerTokens()private{for(uintj=0;j<investedPeersAddress.length;++j)for(uinti=0;i<exchangeGroupKeys.length;++i)peerTokens[investedPeersAddress[j]][exchangeGroupKeys[i]]=walletTokens[exchangeGroupKeys[i]]*ownership[investedPeersAddress[j]];}functionresetPeerWallet()private{for(;investedPeersAddress.length>0;){peerAmount[investedPeersAddress[0]]=0;isInvestedPeer[investedPeersAddress[0]]=0;investedPeersAddress[0]=investedPeersAddress[investedPeersAddress.length-1];deleteinvestedPeersAddress[investedPeersAddress.length-1];--investedPeersAddress.length;}totalInvested=0;}functionwithdrawAllTokens()public{if(validatePeer(msg.sender)==true)for(uinti=0;i<exchangeGroupKeys.length;++i)ERC20(exchangeGroupKeys[i]).safeTransfer(address(this),msg.sender,walletTokens[exchangeGroupKeys[i]]);}functionwithdrawTokens(address_exchangeGroupKey)public{if(validatePeer(msg.sender)==true)ERC20(_exchangeGroupKey).safeTransfer(address(this),msg.sender,walletTokens[_exchangeGroupKey]);}functionaddPeers(address[]_peers)publicreturns(bool){if(leader==msg.sender){if(_peers.length>1){for(uinti=0;i<_peers.length;++i)peers.push(_peers[i]);}else{peers.push(_peers[0]);}returntrue;}returnfalse;}functionremovePeer(address_peer)public{if(leader==msg.sender){if(peers[peers.length-1]==_peer){deletepeers[peers.length-1];peers.length--;return;}else{for(uinti=0;i<peers.length;++i)if(peers[i]==_peer){peers[i]=peers[peers.length-1];deletepeers[peers.length-1];peers.length--;return;}}}}}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 48
column: 14
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 51
column: 14
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 54
column: 12
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 57
column: 14
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 60
column: 12
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 63
column: 11
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 66
column: 9
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 69
column: 9
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 89
column: 30
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 94
column: 31
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 99
column: 30
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 105
column: 51
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 110
column: 30
content: private

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 18
column: 31
content: address[]_peers

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 18
column: 49
content: address[]_exchangeGroups

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 18
column: 76
content: uint[]_distribution

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 124
column: 17
content: address[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 206
column: 16
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 228
column: 47
content: address[]_peers

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 228
column: 65
content: address[]_exchangeGroupKeys

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 228
column: 95
content: uint[]_distribution

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 395
column: 22
content: address[]_peers

SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_ARRAY_LENGTH_MANIPULATION :3
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :13
SOLIDITY_EXTRA_GAS_IN_LOOPS :9
SOLIDITY_ADDRESS_HARDCODED :1
SOLIDITY_UPGRADE_TO_050 :9
SOLIDITY_GAS_LIMIT_IN_LOOPS :8
