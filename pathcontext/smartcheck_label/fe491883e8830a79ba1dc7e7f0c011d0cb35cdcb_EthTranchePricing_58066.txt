C:\Users\hp\DataSet\contracts\ropsten\fe\fe491883e8830a79ba1dc7e7f0c011d0cb35cdcb_EthTranchePricing.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 51
column: 4
content: _owner=address(0)

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 201
column: 4
content: functiongetTranche(uint256n)publicconstantreturns(uint256,uint256){return(_tranches[n]._stage,_tranches[n]._price);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 205
column: 2
content: functiongetFirstTranche()privateconstantreturns(Tranches){return_tranches[0];}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 209
column: 2
content: functiongetLastTranche()privateconstantreturns(Tranches){return_tranches[trancheCount-1];}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 213
column: 2
content: functiongetPricingStartsAt()publicconstantreturns(uint256){returngetFirstTranche()._stage;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 217
column: 2
content: functiongetPricingEndsAt()publicconstantreturns(uint256){returngetLastTranche()._stage;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 221
column: 4
content: functiongetCurrentTranche(uint256stageRaised)privateconstantreturns(Tranches){uint256i;for(i=0;i<_tranches.length;i++){if(stageRaised<_tranches[i]._stage){return_tranches[i-1];}}}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 245
column: 4
content: functiongetCurrentPrice(uintstageRaised)publicconstantreturns(uint256result){returngetCurrentTranche(stageRaised)._price;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 168
column: 8
content: for(uint8i=0;i<_tranches.length/2;i++){j=i;if(tranches[j*2]<6){require(block.timestamp>=tranches[j*2]&&tranches[j*2]<tranches[j*2+2]);}elseif(tranches[j*2]==6){require(tranches[j*2]>tranches[j*2-2]);}_tranches[i]._stage=tranches[i*2];_tranches[i]._price=tranches[i*2+1];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 189
column: 8
content: for(uinti=0;i<_tranches.length/2;i++){_tranches[i]._stage=tranches[i*2]*10**_decimals;_tranches[i]._price=tranches[i*2+1]*10**_decimals;require(!((highestAmount!=0)&&(_tranches[i]._stage<=highestAmount)));highestAmount=_tranches[i]._stage;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 223
column: 4
content: for(i=0;i<_tranches.length;i++){if(stageRaised<_tranches[i]._stage){return_tranches[i-1];}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 231
column: 4
content: for(i=0;i<_tranches.length;i++){if(stageRaised<=_tranches[i]._stage){if(i==3){_tranches[3]._stage=_tranches[i]._stage;_tranches[3]._price=_tranches[i-1]._price;return_tranches[3];}else{return_tranches[i];}}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 223
column: 4
content: for(i=0;i<_tranches.length;i++){if(stageRaised<_tranches[i]._stage){return_tranches[i-1];}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 231
column: 4
content: for(i=0;i<_tranches.length;i++){if(stageRaised<=_tranches[i]._stage){if(i==3){_tranches[3]._stage=_tranches[i]._stage;_tranches[3]._price=_tranches[i-1]._price;return_tranches[3];}else{return_tranches[i];}}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 132
column: 0
content: contractEthTranchePricingisOwnable{usingSafeMathforuint256;boolpublic_trancheTimeStatus=false;boolpublic_trancheWeiStatus=false;uint256public_stageRaised=0;uint256_decimals=18;uint256public_nextTrancheStage=0;uint256public_nextTranchePrice=0;uint256public_sum=0;uint256public_rest=0;uint256public_restValue=0;uint256publicconstantMAX_TRANCHES=8;structTranches{uint256_stage;uint256_price;}Tranches[MAX_TRANCHES]public_tranches;uint256trancheCount;modifieronlyTrancheStatus(){require(_trancheTimeStatus==false);require(_trancheWeiStatus==false);_;}functionsetTranchTime(uint256[]tranches)publiconlyTrancheStatusonlyOwner{require(!(tranches.length%2==1||tranches.length>=MAX_TRANCHES*2));trancheCount=_tranches.length/2;uint8j;for(uint8i=0;i<_tranches.length/2;i++){j=i;if(tranches[j*2]<6){require(block.timestamp>=tranches[j*2]&&tranches[j*2]<tranches[j*2+2]);}elseif(tranches[j*2]==6){require(tranches[j*2]>tranches[j*2-2]);}_tranches[i]._stage=tranches[i*2];_tranches[i]._price=tranches[i*2+1];}_trancheTimeStatus=true;}functionsetTranchWei(uint256[]tranches)publiconlyTrancheStatusonlyOwner{require(!(tranches.length%2==1||tranches.length>=MAX_TRANCHES*2));trancheCount=_tranches.length/2;uint256highestAmount=0;require(_tranches[0]._stage==0);for(uinti=0;i<_tranches.length/2;i++){_tranches[i]._stage=tranches[i*2]*10**_decimals;_tranches[i]._price=tranches[i*2+1]*10**_decimals;require(!((highestAmount!=0)&&(_tranches[i]._stage<=highestAmount)));highestAmount=_tranches[i]._stage;}require(_tranches[0]._stage==0);require(_tranches[trancheCount-1]._price==0);_trancheWeiStatus=true;}functiongetTranche(uint256n)publicconstantreturns(uint256,uint256){return(_tranches[n]._stage,_tranches[n]._price);}functiongetFirstTranche()privateconstantreturns(Tranches){return_tranches[0];}functiongetLastTranche()privateconstantreturns(Tranches){return_tranches[trancheCount-1];}functiongetPricingStartsAt()publicconstantreturns(uint256){returngetFirstTranche()._stage;}functiongetPricingEndsAt()publicconstantreturns(uint256){returngetLastTranche()._stage;}functiongetCurrentTranche(uint256stageRaised)privateconstantreturns(Tranches){uint256i;for(i=0;i<_tranches.length;i++){if(stageRaised<_tranches[i]._stage){return_tranches[i-1];}}}functiongetNextTranche(uint256stageRaised)privatereturns(Tranches){uint256i;for(i=0;i<_tranches.length;i++){if(stageRaised<=_tranches[i]._stage){if(i==3){_tranches[3]._stage=_tranches[i]._stage;_tranches[3]._price=_tranches[i-1]._price;return_tranches[3];}else{return_tranches[i];}}}}functiongetCurrentPrice(uintstageRaised)publicconstantreturns(uint256result){returngetCurrentTranche(stageRaised)._price;}functioncalculatePrice(uint256value)externalreturns(uint256){uint256multiplier=10**_decimals;uint256_result;uint256price;if(_trancheTimeStatus==true&&_trancheWeiStatus==false){_stageRaised=block.timestamp;price=getCurrentPrice(_stageRaised);_result=value.mul(multiplier).div(price);}elseif(_trancheTimeStatus==false&&_trancheWeiStatus==true){_nextTrancheStage=getNextTranche(_stageRaised)._stage;_nextTranchePrice=getNextTranche(_stageRaised)._price;_sum=_stageRaised.add(value);if(_sum>=_nextTrancheStage){_rest=_sum.sub(_nextTrancheStage);_restValue=value;_restValue=_restValue.sub(_rest);uint256_price=getCurrentPrice(_stageRaised);_result=((_restValue.mul(multiplier).div(_price)).add(_rest.mul(multiplier).div(_nextTranchePrice)));}else{price=getCurrentPrice(_stageRaised);_result=value.mul(multiplier).div(price);}_stageRaised=_stageRaised.add(value);}return_result;}function()publicpayable{require(false);}}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 163
column: 4
content: functionsetTranchTime(uint256[]tranches)publiconlyTrancheStatusonlyOwner{require(!(tranches.length%2==1||tranches.length>=MAX_TRANCHES*2));trancheCount=_tranches.length/2;uint8j;for(uint8i=0;i<_tranches.length/2;i++){j=i;if(tranches[j*2]<6){require(block.timestamp>=tranches[j*2]&&tranches[j*2]<tranches[j*2+2]);}elseif(tranches[j*2]==6){require(tranches[j*2]>tranches[j*2-2]);}_tranches[i]._stage=tranches[i*2];_tranches[i]._price=tranches[i*2+1];}_trancheTimeStatus=true;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 184
column: 4
content: functionsetTranchWei(uint256[]tranches)publiconlyTrancheStatusonlyOwner{require(!(tranches.length%2==1||tranches.length>=MAX_TRANCHES*2));trancheCount=_tranches.length/2;uint256highestAmount=0;require(_tranches[0]._stage==0);for(uinti=0;i<_tranches.length/2;i++){_tranches[i]._stage=tranches[i*2]*10**_decimals;_tranches[i]._price=tranches[i*2+1]*10**_decimals;require(!((highestAmount!=0)&&(_tranches[i]._stage<=highestAmount)));highestAmount=_tranches[i]._stage;}require(_tranches[0]._stage==0);require(_tranches[trancheCount-1]._price==0);_trancheWeiStatus=true;}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 3
column: 10
content: private

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 133
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 91h3sa
severity: 1
line: 286
column: 12
content: public

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 163
column: 27
content: uint256[]tranches

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 184
column: 26
content: uint256[]tranches

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 205
column: 55
content: Tranches

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 209
column: 54
content: Tranches

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 221
column: 78
content: Tranches

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 229
column: 65
content: Tranches

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 137
column: 4
content: uint256_decimals=18;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 154
column: 4
content: uint256trancheCount;

SOLIDITY_VISIBILITY :2
SOLIDITY_SAFEMATH :1
SOLIDITY_OVERPOWERED_ROLE :2
SOLIDITY_DEPRECATED_CONSTRUCTIONS :7
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :1
SOLIDITY_EXTRA_GAS_IN_LOOPS :4
SOLIDITY_ADDRESS_HARDCODED :1
SOLIDITY_UPGRADE_TO_050 :7
SOLIDITY_GAS_LIMIT_IN_LOOPS :2
