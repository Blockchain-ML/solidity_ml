C:\Users\hp\DataSet\contracts\ropsten\41\418c287aa5286369e3bb05ff5c7a1991ab6db1c1_ServiceContract.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 480
column: 36
content: 0xb0e49d91c41C577Ed90E2fC65CA766EB518682D2

ruleId: SOLIDITY_DIV_MUL
patternId: 09hhh1
severity: 2
line: 602
column: 32
content: (1ether*price*100/tr.USDValue())*_startDates.length

ruleId: SOLIDITY_DIV_MUL
patternId: 09hhh1
severity: 2
line: 692
column: 46
content: (r.totalPrice*110/100)*refundPolicy.values[refundPolicy.indexes[i]]

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 43
column: 8
content: for(uinti=1;i<_times.length;i++){if(getTimestampOfDayStart(_times[i])!=getTimestampOfDayStart(_times[i-1])+1days)return(getTimestampOfDayStart(_times[i-1])+1days);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 51
column: 8
content: for(uinti=1;i<_times.length;i++){if(getTimestampOfDayStart(_times[i])!=getTimestampOfDayStart(_times[i-1])+86400)returnfalse;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 579
column: 12
content: for(uinti=0;i<_startDates.length;i++){if(availableSpots[btu.getTimestampOfDayStart(_startDates[i])]+_numberOfSlots>maxAvailableSpots)returnfalse;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 587
column: 12
content: for(uinti=0;i<_startDates.length;i++){availableSpots[btu.getTimestampOfDayStart(_startDates[i])]=availableSpots[btu.getTimestampOfDayStart(_startDates[i])]+_numberOfGuests;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 746
column: 8
content: for(uinti=0;i<contractNbr;i++){addrs[i]=contractsIndex[i];}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 579
column: 12
content: for(uinti=0;i<_startDates.length;i++){if(availableSpots[btu.getTimestampOfDayStart(_startDates[i])]+_numberOfSlots>maxAvailableSpots)returnfalse;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 587
column: 12
content: for(uinti=0;i<_startDates.length;i++){availableSpots[btu.getTimestampOfDayStart(_startDates[i])]=availableSpots[btu.getTimestampOfDayStart(_startDates[i])]+_numberOfGuests;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 212
column: 23
content: secondsAccountedFor>timestamp

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 4
column: 13
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 314
column: 29
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 337
column: 28
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 377
column: 47
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 380
column: 28
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 381
column: 21
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 476
column: 9
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 478
column: 21
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 480
column: 12
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 483
column: 20
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 484
column: 14
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 485
column: 21
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 486
column: 13
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 717
column: 29
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 721
column: 21
content: private

ruleId: SOLIDITY_TRANSFER_IN_LOOP
patternId: 8jdj43
severity: 2
line: 686
column: 20
content: for(uinti=0;i<=2;i++){if(i==2){r.client.transfer(r.totalPrice*110/100);break;}if(refundPolicy.indexes[i]>dayDifference){r.client.transfer((r.totalPrice*110/100)*refundPolicy.values[refundPolicy.indexes[i]]/100);owner.transfer(r.totalPrice*(100-refundPolicy.values[refundPolicy.indexes[i]])/100);pleaseAddress.transfer(r.totalPrice*(100-refundPolicy.values[refundPolicy.indexes[i]])/1000);break;}}

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 10
column: 29
content: uint[]_startTimes

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 10
column: 49
content: uint[]_endTimes

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 26
column: 45
content: uint[]_startTimes

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 34
column: 46
content: uint[]_endTimes

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 42
column: 27
content: uint[]_times

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 50
column: 35
content: uint[]_times

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 155
column: 71
content: _DateTimedt

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 421
column: 70
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 494
column: 8
content: uint[]start

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 495
column: 8
content: uint[]end

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 496
column: 8
content: string_IPFSHash

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 499
column: 8
content: uint[]daysBefore

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 500
column: 8
content: uint[]percentage

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 560
column: 26
content: uint[]_start

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 560
column: 41
content: uint[]_end

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 570
column: 29
content: string_IPFSHash

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 578
column: 24
content: uint[]_startDates

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 586
column: 36
content: uint[]_startDates

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 592
column: 22
content: uint[]_startDates

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 744
column: 52
content: address[]

ruleId: SOLIDITY_VAR
patternId: d28aa7
severity: 2
line: 700
column: 21
content: varj=0

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 344
column: 4
content: functionEventHub(addressscrAddr){scr=ServiceContractResolver(scrAddr);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 348
column: 4
content: functionnewBookingfc(uintID,addressuser,uintstart,uintnbrOfSession,uintslots)serviceContractOnly(msg.sender){newBooking(msg.sender,user,ID,start,nbrOfSession,slots);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 352
column: 4
content: functioncanceledBookingfc(uintID)serviceContractOnly(msg.sender){canceledBooking(msg.sender,ID);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 356
column: 4
content: functionacceptedBookingfc(uintID)serviceContractOnly(msg.sender){acceptedBooking(msg.sender,ID);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 360
column: 4
content: functionrejectedBookingfc(uintID)serviceContractOnly(msg.sender){rejectedBooking(msg.sender,ID);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 398
column: 4
content: functionRatingsContract(addressserviceContractResolver,addressdelegateResolver){scr=ServiceContractResolver(serviceContractResolver);dr=DelegateResolver(delegateResolver);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 665
column: 8
content: functioncancelReservation(uintreservationID){Reservationstorager=reservations[reservationID];addressclient=r.client;require(msg.sender==owner||msg.sender==client);require(now<r.startTime);if(r.stage==Stages.PendingAccept){r.client.transfer(r.totalPrice*110/100);r.stage=Stages.Canceled;for(uintd=0;d<r.numberOfSessions;d++){availableSpots[btu.getTimestampOfDayStart(r.startTime+d*1days)]=availableSpots[btu.getTimestampOfDayStart(r.startTime+d*1days)]-r.numberOfGuests;}eh.canceledBookingfc(reservationID);}if(r.stage==Stages.Booked){if(msg.sender==owner){r.client.transfer(r.totalPrice*110/100);}else{uintdayNow=btu.getTimestampOfDayStart(now);uintdayStart=btu.getTimestampOfDayStart(r.startTime);uintdayDifference=(dayStart-dayNow)/86400;for(uinti=0;i<=2;i++){if(i==2){r.client.transfer(r.totalPrice*110/100);break;}if(refundPolicy.indexes[i]>dayDifference){r.client.transfer((r.totalPrice*110/100)*refundPolicy.values[refundPolicy.indexes[i]]/100);owner.transfer(r.totalPrice*(100-refundPolicy.values[refundPolicy.indexes[i]])/100);pleaseAddress.transfer(r.totalPrice*(100-refundPolicy.values[refundPolicy.indexes[i]])/1000);break;}}}r.stage=Stages.Canceled;for(varj=0;j<r.numberOfSessions;j++){availableSpots[btu.getTimestampOfDayStart(r.startTime+j*1days)]=availableSpots[btu.getTimestampOfDayStart(r.startTime+j*1days)]-r.numberOfGuests;}eh.canceledBookingfc(reservationID);}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 734
column: 4
content: functionServiceContractResolver(addressdelegateResolver){dr=DelegateResolver(delegateResolver);}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 113
column: 8
content: uintconstantDAY_IN_SECONDS=86400;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 114
column: 8
content: uintconstantYEAR_IN_SECONDS=31536000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 115
column: 8
content: uintconstantLEAP_YEAR_IN_SECONDS=31622400;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 117
column: 8
content: uintconstantHOUR_IN_SECONDS=3600;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 118
column: 8
content: uintconstantMINUTE_IN_SECONDS=60;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 120
column: 8
content: uint16constantORIGIN_YEAR=1970;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 479
column: 4
content: RefundConfigrefundPolicy;

SOLIDITY_VISIBILITY :15
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :15
SOLIDITY_VAR :1
SOLIDITY_EXTRA_GAS_IN_LOOPS :5
SOLIDITY_ADDRESS_HARDCODED :1
SOLIDITY_UPGRADE_TO_050 :20
SOLIDITY_GAS_LIMIT_IN_LOOPS :3
SOLIDITY_DIV_MUL :2
SOLIDITY_TRANSFER_IN_LOOP :1
