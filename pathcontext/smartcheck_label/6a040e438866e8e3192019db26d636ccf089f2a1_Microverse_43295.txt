C:\Users\hp\DataSet\contracts\ropsten\6a\6a040e438866e8e3192019db26d636ccf089f2a1_Microverse.sol
jar:file:/C:/Users/hp/AppData/Roaming/npm/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 244
column: 0
content: contractMicroverseisHexBoard3,PullPayment,Ownable,TaxRules,JackpotRules{usingSafeMathforuint256;usingMathforuint256;enumStage{DutchAuction,GameRounds}Stagepublicstage=Stage.DutchAuction;modifieratStage(Stage_stage){require(stage==_stage,"Function cannot be called at this time.");_;}constructor(uintstartingStage)public{if(startingStage==uint(Stage.GameRounds)){stage=Stage.GameRounds;_startGameRound();}else{_startAuction();}}mapping(uint8=>address)publictileToOwner;mapping(uint8=>uint256)publictileToPrice;uint256publictotalTileValue;function_changeTilePrice(uint8tileId,uint256newPrice)private{uint256oldPrice=tileToPrice[tileId];tileToPrice[tileId]=newPrice;totalTileValue=(totalTileValue.sub(oldPrice)).add(newPrice);}eventTileOwnerChanged(uint8indexedtileId,addressindexedoldOwner,addressindexednewOwner,uint256oldPrice,uint256newPrice);addresspublicteamAddress1;addresspublicteamAddress2;addresspublicteamAddress3;uint256publicteamSize=0;functionaddTeamAddress(addressnewTeamAddress)externalonlyOwner{require(newTeamAddress!=address(0),"New team member must not be null team address");require(newTeamAddress!=owner,"New team member must not be contract owner");require(teamAddress1==address(0)||teamAddress2==address(0)||teamAddress3==address(0),"Must be an open spot for a new team member! This prevents changing the team once all slots are filled.");if(teamAddress1==address(0)){teamAddress1=newTeamAddress;teamSize=teamSize.add(1);}elseif(teamAddress2==address(0)){teamAddress2=newTeamAddress;teamSize=teamSize.add(1);}elseif(teamAddress3==address(0)){teamAddress3=newTeamAddress;teamSize=teamSize.add(1);}}function_sendToTeam(uint256amount)private{if(teamSize==0){asyncSend(owner,amount);}else{uint256perTeamMemberFee=amount.div(teamSize);if(teamAddress1!=address(0)){asyncSend(teamAddress1,perTeamMemberFee);}if(teamAddress2!=address(0)){asyncSend(teamAddress2,perTeamMemberFee);}if(teamAddress3!=address(0)){asyncSend(teamAddress3,perTeamMemberFee);}}}eventAuctionStarted(uint256startingAuctionPrice,uint256endingAuctionPrice,uint256auctionDuration,uint256startTime);eventAuctionEnded(uint256endTime);uint256constantpublicstartingAuctionPrice=1ether;uint256constantpublicendingAuctionPrice=0.05ether;uint256constantpublicauctionDuration=5days;uint256publicnumBoughtTiles;uint256publicauctionStartTime;functionbuyTileAuction(uint8tileId,uint256newPrice,addressreferrer)publicpayableatStage(Stage.DutchAuction){require(tileToOwner[tileId]==address(0)&&tileToPrice[tileId]==0,"Can&#39;t buy a tile that&#39;s already been auctioned off");uint256tax=_priceToTax(newPrice);uint256price=getTilePriceAuction();require(msg.value>=tax.add(price),"Must pay the full price and tax for a tile on auction");_distributeAuctionTax(msg.value,referrer);tileToOwner[tileId]=msg.sender;_changeTilePrice(tileId,newPrice);numBoughtTiles=numBoughtTiles.add(1);emitTileOwnerChanged(tileId,address(0),msg.sender,price,newPrice);if(numBoughtTiles>=numTiles){endAuction();}}function_distributeAuctionTax(uint256tax,addressreferrer)private{_distributeLandholderTax(_totalLandholderTax(tax));uint256totalJackpotTax=_jackpotTax(tax).add(_nextPotTax(tax));nextJackpot=nextJackpot.add(totalJackpotTax);boolhasReferrer=referrer!=address(0);_sendToTeam(_teamTax(tax,hasReferrer));asyncSend(referrer,_referrerTax(tax,hasReferrer));}functiongetTilePriceAuction()publicviewatStage(Stage.DutchAuction)returns(uint256){uint256secondsPassed=0;if(now>auctionStartTime){secondsPassed=now.sub(auctionStartTime);}if(secondsPassed>=auctionDuration){returnendingAuctionPrice;}else{uint256maxPriceDelta=startingAuctionPrice.sub(endingAuctionPrice);uint256actualPriceDelta=(maxPriceDelta.mul(secondsPassed)).div(auctionDuration);returnstartingAuctionPrice.sub(actualPriceDelta);}}functionendAuction()private{require(numBoughtTiles>=numTiles,"Can&#39;t end auction if are unbought tiles");stage=Stage.GameRounds;_startGameRound();emitAuctionEnded(now);}function_startAuction()private{auctionStartTime=now;numBoughtTiles=0;emitAuctionStarted(startingAuctionPrice,endingAuctionPrice,auctionDuration,auctionStartTime);}uint256constantpublicstartingRoundExtension=12hours;uint256constantpublichalvingVolume=50ether;uint256constantpublicminRoundExtension=10seconds;uint256publicroundNumber=0;uint256publiccurExtensionVolume;uint256publiccurRoundExtension;uint256publicroundEndTime;uint256publicjackpot;uint256publicnextJackpot;eventTilePriceChanged(uint8indexedtileId,addressindexedowner,uint256oldPrice,uint256newPrice);eventGameRoundStarted(uint256initJackpot,uint256endTime,uint256roundNumber);eventGameRoundExtended(uint256endTime);eventGameRoundEnded(uint256jackpot);functionroundTimeRemaining()publicviewatStage(Stage.GameRounds)returns(uint256){if(_roundOver()){return0;}else{returnroundEndTime.sub(now);}}function_extendRound()private{roundEndTime=roundEndTime.max(now.add(curRoundExtension));emitGameRoundExtended(roundEndTime);}function_startGameRound()private{curExtensionVolume=0ether;curRoundExtension=startingRoundExtension;jackpot=nextJackpot;nextJackpot=0;roundNumber=roundNumber.add(1);_extendRound();emitGameRoundStarted(jackpot,roundEndTime,roundNumber);}function_roundOver()privateviewreturns(bool){returnnow>=roundEndTime;}modifierduringRound(){require(!_roundOver(),"Round can&#39;t be over!");_;}function_logRoundExtensionVolume(uint256amount)private{curExtensionVolume=curExtensionVolume.add(amount);if(curExtensionVolume>=halvingVolume){curRoundExtension=curRoundExtension.div(2).max(minRoundExtension);curExtensionVolume=0ether;}}functionendGameRound()publicatStage(Stage.GameRounds){require(_roundOver(),"Round must be over!");_distributeJackpot();emitGameRoundEnded(jackpot);_startGameRound();}functionsetTilePrice(uint8tileId,uint256newPrice,addressreferrer)publicpayableatStage(Stage.GameRounds)duringRound{require(tileToOwner[tileId]==msg.sender,"Can&#39;t set tile price for a tile you don&#39;t own!");uint256tax=_priceToTax(newPrice);require(msg.value>=tax,"Must pay tax on new tile price!");uint256oldPrice=tileToPrice[tileId];_distributeTax(msg.value,referrer);_changeTilePrice(tileId,newPrice);_extendRound();_logRoundExtensionVolume(msg.value);emitTilePriceChanged(tileId,tileToOwner[tileId],oldPrice,newPrice);}functionbuyTile(uint8tileId,uint256newPrice,addressreferrer)publicpayableatStage(Stage.GameRounds)duringRound{addressoldOwner=tileToOwner[tileId];require(oldOwner!=msg.sender,"Can&#39;t buy a tile you already own");uint256tax=_priceToTax(newPrice);uint256oldPrice=tileToPrice[tileId];require(msg.value>=tax.add(oldPrice),"Must pay full price and tax for tile");asyncSend(oldOwner,tileToPrice[tileId]);tileToOwner[tileId]=msg.sender;uint256actualTax=msg.value.sub(oldPrice);_distributeTax(actualTax,referrer);_changeTilePrice(tileId,newPrice);_extendRound();_logRoundExtensionVolume(msg.value);emitTileOwnerChanged(tileId,oldOwner,msg.sender,oldPrice,newPrice);}function_distributeJackpot()private{uint256winnerJackpot=_winnerJackpot(jackpot);uint256landholderJackpot=_landholderJackpot(jackpot);_distributeWinnerAndLandholderJackpot(winnerJackpot,landholderJackpot);_sendToTeam(_teamJackpot(jackpot));nextJackpot=nextJackpot.add(_nextPotJackpot(jackpot));}function_calculatePriceComplement(uint8tileId)privateviewreturns(uint256){returntotalTileValue.sub(tileToPrice[tileId]);}function_distributeWinnerAndLandholderJackpot(uint256winnerJackpot,uint256landholderJackpot)private{uint256[]memorycomplements=newuint256[](numTiles+1);uint256totalPriceComplement=0;uint256bestComplement=0;uint8lastWinningTileId=0;for(uint8i=minTileId;i<=maxTileId;i++){uint256priceComplement=_calculatePriceComplement(i);if(bestComplement==0||priceComplement>bestComplement){bestComplement=priceComplement;lastWinningTileId=i;}complements[i]=priceComplement;totalPriceComplement=totalPriceComplement.add(priceComplement);}uint256numWinners=0;for(i=minTileId;i<=maxTileId;i++){if(_calculatePriceComplement(i)==bestComplement){numWinners++;}}if(numWinners==1){asyncSend(tileToOwner[lastWinningTileId],winnerJackpot);}else{for(i=minTileId;i<=maxTileId;i++){if(_calculatePriceComplement(i)==bestComplement){asyncSend(tileToOwner[i],winnerJackpot.div(numWinners));}}}for(i=minTileId;i<=maxTileId;i++){uint256landholderAllocation=complements[i].mul(landholderJackpot).div(totalPriceComplement);asyncSend(tileToOwner[i],landholderAllocation);}}function_distributeTax(uint256tax,addressreferrer)private{jackpot=jackpot.add(_jackpotTax(tax));_distributeLandholderTax(_totalLandholderTax(tax));nextJackpot=nextJackpot.add(_nextPotTax(tax));boolhasReferrer=referrer!=address(0);_sendToTeam(_teamTax(tax,hasReferrer));asyncSend(referrer,_referrerTax(tax,hasReferrer));}function_distributeLandholderTax(uint256tax)private{for(uint8tile=minTileId;tile<=maxTileId;tile++){if(tileToOwner[tile]!=address(0)&&tileToPrice[tile]!=0){uint256tilePrice=tileToPrice[tile];uint256allocation=tax.mul(tilePrice).div(totalTileValue);asyncSend(tileToOwner[tile],allocation);}}}}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 20
column: 2
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 106
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 199
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 250
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_UNCHECKED_CALL
patternId: f39eed
severity: 3
line: 418
column: 8
content: _sendToTeam(_teamTax(tax,hasReferrer))

ruleId: SOLIDITY_UNCHECKED_CALL
patternId: f39eed
severity: 3
line: 644
column: 8
content: _sendToTeam(_teamJackpot(jackpot))

ruleId: SOLIDITY_UNCHECKED_CALL
patternId: f39eed
severity: 3
line: 706
column: 8
content: _sendToTeam(_teamTax(tax,hasReferrer))

SOLIDITY_SAFEMATH :4
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_UNCHECKED_CALL :3
